
############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: train
 Savepath: ./runs/15032024-134549/
 Seed: 2026


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: test
 Savepath: ./runs/15032024-134549/
 Seed: 4052


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]
New run folder created successfuly: ./runs/15032024-134549/
Completed copied scripts 
WARNING: You did not provide a dataloader id. A new one has been generated: 134634
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: You did not provide a dataloader id. A new one has been generated: 134634
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.


Total number of parameters in the model: 8420572 


WARNING: No key provided for the context initialization. Initializing at 0.
WARNING: No key provided, using time as seed


=== Beginning training with proximal alternating minimization ... ===
    Number of examples in a batch: 1
    Maximum number of steps per inner minimization: 20
    Maximum number of outer minimizations: 200
    Maximum total number of training steps: 4000

Compiling function "train_step" for neural ode ...
Shapes of elements in a batch: (4, 1, 10, 2048) (10,)

Compiling function "train_step" for context ...
Shapes of elements in a batch: (4, 1, 10, 2048) (10,)
    Outer Step:     0      LossTrajs: 0.26960647     ContextsNorm: 0.00000000     ValIndCrit: 0.05888338
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    1
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 2.88e-06
        -DiffCxt:  inf
    Outer Step:     1      LossTrajs: 0.04211318     ContextsNorm: 0.00944442     ValIndCrit: 0.04090606
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 4.98e-05
        -DiffCxt:  2.13e-03
    Outer Step:     2      LossTrajs: 0.02038058     ContextsNorm: 0.00918118     ValIndCrit: 0.04719812
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 3.43e-04
        -DiffCxt:  2.20e-04
    Outer Step:     3      LossTrajs: 0.01637063     ContextsNorm: 0.00934507     ValIndCrit: 0.04851390
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 5.34e-05
        -DiffCxt:  2.89e-05
    Outer Step:    10      LossTrajs: 0.01349434     ContextsNorm: 0.00918584     ValIndCrit: 0.06051847
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 6.24e-06
        -DiffCxt:  1.71e-05
    Outer Step:    20      LossTrajs: 0.00797887     ContextsNorm: 0.00947703     ValIndCrit: 0.15736179
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 8.53e-06
        -DiffCxt:  6.04e-05
    Outer Step:    30      LossTrajs: 0.00677018     ContextsNorm: 0.01012276     ValIndCrit: 0.28261268
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   17
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 1.97e-06
        -DiffCxt:  8.48e-06
    Outer Step:    40      LossTrajs: 0.00638868     ContextsNorm: 0.01008592     ValIndCrit: 0.24114218
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    3
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 1.95e-06
        -DiffCxt:  6.68e-06
    Outer Step:    50      LossTrajs: 0.00617762     ContextsNorm: 0.01005008     ValIndCrit: 0.24137890
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    3
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 1.65e-06
        -DiffCxt:  5.00e-06
    Outer Step:    60      LossTrajs: 0.00604937     ContextsNorm: 0.01015131     ValIndCrit: 0.21168995
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 1.90e-06
        -DiffCxt:  1.13e-05
    Outer Step:    70      LossTrajs: 0.00594952     ContextsNorm: 0.00990007     ValIndCrit: 0.23133400
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 3.35e-06
        -DiffCxt:  1.22e-05
    Outer Step:    80      LossTrajs: 0.00571985     ContextsNorm: 0.00961718     ValIndCrit: 0.22270700
        -NbInnerStepsNode:    3
        -NbInnerStepsCxt:    3
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 2.00e-06
        -DiffCxt:  9.33e-06
    Outer Step:    90      LossTrajs: 0.00557392     ContextsNorm: 0.01016386     ValIndCrit: 0.17866290
        -NbInnerStepsNode:   17
        -NbInnerStepsCxt:    5
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 1.81e-06
        -DiffCxt:  9.24e-06
    Outer Step:   100      LossTrajs: 0.00545908     ContextsNorm: 0.01004737     ValIndCrit: 0.19459435
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    2
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 1.41e-06
        -DiffCxt:  4.73e-06
    Outer Step:   110      LossTrajs: 0.00539042     ContextsNorm: 0.01004029     ValIndCrit: 0.21196491
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    1
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 1.10e-06
        -DiffCxt:  3.10e-06
    Outer Step:   120      LossTrajs: 0.00559298     ContextsNorm: 0.01016199     ValIndCrit: 0.19968228
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:    2
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 3.89e-06
        -DiffCxt:  5.70e-06
    Outer Step:   130      LossTrajs: 0.00538385     ContextsNorm: 0.01021240     ValIndCrit: 0.23742364
        -NbInnerStepsNode:    6
        -NbInnerStepsCxt:    2
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 1.84e-06
        -DiffCxt:  8.45e-06
    Outer Step:   140      LossTrajs: 0.00531584     ContextsNorm: 0.01019316     ValIndCrit: 0.27901065
        -NbInnerStepsNode:    2
        -NbInnerStepsCxt:    2
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 1.80e-06
        -DiffCxt:  8.05e-06
    Outer Step:   150      LossTrajs: 0.00662690     ContextsNorm: 0.01035813     ValIndCrit: 0.11933992
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:    1
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 1.38e-05
        -DiffCxt:  7.97e-06
    Outer Step:   160      LossTrajs: 0.00523686     ContextsNorm: 0.01038001     ValIndCrit: 0.24902384
        -NbInnerStepsNode:    3
        -NbInnerStepsCxt:    1
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 1.56e-06
        -DiffCxt:  8.79e-06
    Outer Step:   170      LossTrajs: 0.00508223     ContextsNorm: 0.01027705     ValIndCrit: 0.25934151
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    2
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 1.50e-06
        -DiffCxt:  7.04e-06
    Outer Step:   180      LossTrajs: 0.00498870     ContextsNorm: 0.01047034     ValIndCrit: 0.32962686
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    6
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 1.54e-06
        -DiffCxt:  9.48e-06
    Outer Step:   190      LossTrajs: 0.00500218     ContextsNorm: 0.01035655     ValIndCrit: 0.35452095
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    2
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 1.92e-06
        -DiffCxt:  1.52e-06
    Outer Step:   199      LossTrajs: 0.00502300     ContextsNorm: 0.01026056     ValIndCrit: 0.32391435
        -NbInnerStepsNode:   16
        -NbInnerStepsCxt:    2
        -InnerToleranceNode: 2.00e-06
        -InnerToleranceCtx:  1.00e-05
        -DiffNode: 1.89e-06
        -DiffCxt:  6.33e-06

Total gradient descent training time: 0 hours 26 mins 28 secs
Environment weights at the end of the training: [0.25 0.25 0.25 0.25]
WARNING: You did not provide a dataloader id. A new one has been generated: 141308
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: No key provided, using time as seed
==  Begining in-domain testing ... ==
    Number of training environments: 4
    Final length of the training trajectories: 10
    Length of the testing trajectories: 10
Test Score (In-Domain): 0.32391435


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: adapt
 Savepath: ./runs/15032024-134549/adapt/
 Seed: 6078

==  Begining in-domain visualisation ... ==
    Environment id: 0
    Trajectory id: 12
    Visualized dimensions: (0, 1)
    Final length of the training trajectories: 10
    Length of the testing trajectories: 10
Testing finished. Figure saved in: ./runs/15032024-134549/results_in_domain.png
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: No key provided for the context initialization. Initializing at 0.


=== Beginning adaptation ... ===
    Number of examples in a batch: 1
    Number of train steps per epoch: 1
    Number of training epochs: 50
    Total number of training steps: 50
WARNING: No key provided, using time as seed

Compiling function "train_step" for context ...
Shapes of elements in a batch: (1, 1, 10, 2048) (10,)
    Epoch:     0     LossContext: 5.82183886
    Epoch:     1     LossContext: 0.56692445
    Epoch:     2     LossContext: 4.86811352
    Epoch:     3     LossContext: 0.11588128
    Epoch:    10     LossContext: 2.32337594
    Epoch:    20     LossContext: 0.30434906
    Epoch:    30     LossContext: 0.24101430
    Epoch:    40     LossContext: 0.12255530
    Epoch:    49     LossContext: 0.09797856

Total gradient descent adaptation time: 0 hours 0 mins 34 secs
Environment weights at the end of the adaptation: [1.]

Saving adaptation parameters into ./runs/15032024-134549/adapt/ folder with id 170846 ...

==  Begining out-of-distribution testing ... ==
    Number of training environments: 4
    Number of adaptation environments: 1
    Final length of the training trajectories: 10
    Length of the testing trajectories: 10
Test Score (OOD): 0.10012285

==  Begining out-of-distribution visualisation ... ==
    Environment id: 0
    Trajectory id: 0
    Visualized dimensions: (0, 1)
    Final length of the training trajectories: 10
    Length of the testing trajectories: 10
Testing finished. Figure saved in: ./runs/15032024-134549/adapt/results_ood.png
==  Begining in-domain 2D visualisation ... ==
    Environment id: 2
    Trajectory id: 30
    Length of the testing trajectories: 10
Testing finished. Figure saved in: ./runs/15032024-134549/results_2D_ind.png

Full evaluation of the model on many random seeds


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]


Mean and std of the scores across various datasets

          seed  ind_crit  ood_crit
count 2.00e+01  2.00e+01  2.00e+01
mean  5.61e+03  3.24e-01  1.40e-01
std   2.52e+03  1.04e-02  5.20e-02
