Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: train
 Savepath: ./runs/19112024-202805/
 Seed: 2024

Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: test
 Savepath: ./runs/19112024-202805/
 Seed: 4048


############# Neural Context Flow #############

Jax version: 0.4.35
Available devices: [CudaDevice(id=0)]
Run folder created successfuly: ./runs/19112024-202805/
Completed copied scripts 
WARNING: You did not provide a dataloader id. A new one has been generated: 202808
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: You did not provide a dataloader id. A new one has been generated: 202808
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.


Total number of parameters in the model: 50818 


WARNING: No key provided for the context initialization. Initializing at 0.
WARNING: No key provided, using time as seed


=== Beginning training ... ===
    Number of examples in a batch: 4
    Number of train steps per epoch: 1
    Number of training epochs: 12000
    Total number of training steps: 12000

Compiling function "train_step" for neural ode ...
Shapes of elements in a batch: (25, 4, 40, 2) (40,)

Compiling function "train_step" for context ...
Shapes of elements in a batch: (25, 4, 40, 2) (40,)
    Epoch:     0      LossTrajs: 1.31878018     ContextsNorm: 0.00000000     ValIndCrit: 1.45549929
        Saving best model so far ...
    Epoch:     1      LossTrajs: 1.31562245     ContextsNorm: 0.00009846     ValIndCrit: 1.45265222
        Saving best model so far ...
    Epoch:     2      LossTrajs: 1.31255901     ContextsNorm: 0.00019129     ValIndCrit: 1.44989991
        Saving best model so far ...
    Epoch:     3      LossTrajs: 1.30958641     ContextsNorm: 0.00028300     ValIndCrit: 1.44723797
        Saving best model so far ...
    Epoch:   100      LossTrajs: 1.20362985     ContextsNorm: 0.01038322     ValIndCrit: 1.34734917
        Saving best model so far ...
    Epoch:   200      LossTrajs: 1.08959639     ContextsNorm: 0.01621343     ValIndCrit: 1.23998439
        Saving best model so far ...
    Epoch:   300      LossTrajs: 1.03514445     ContextsNorm: 0.01413457     ValIndCrit: 1.15438461
        Saving best model so far ...
    Epoch:   400      LossTrajs: 1.00919032     ContextsNorm: 0.01310125     ValIndCrit: 1.11348999
        Saving best model so far ...
    Epoch:   500      LossTrajs: 0.99501705     ContextsNorm: 0.01264607     ValIndCrit: 1.09289193
        Saving best model so far ...
    Epoch:   600      LossTrajs: 0.98546952     ContextsNorm: 0.01258477     ValIndCrit: 1.07999623
        Saving best model so far ...
    Epoch:   700      LossTrajs: 0.97714263     ContextsNorm: 0.01339682     ValIndCrit: 1.06941009
        Saving best model so far ...
    Epoch:   800      LossTrajs: 0.96509385     ContextsNorm: 0.01750964     ValIndCrit: 1.05526674
        Saving best model so far ...
    Epoch:   900      LossTrajs: 0.95147377     ContextsNorm: 0.02483454     ValIndCrit: 1.04191506
        Saving best model so far ...
    Epoch:  1000      LossTrajs: 0.94863647     ContextsNorm: 0.02220408     ValIndCrit: 1.03812099
        Saving best model so far ...
    Epoch:  1100      LossTrajs: 1.07238793     ContextsNorm: 0.02231131     ValIndCrit: 1.23447752
    Epoch:  1200      LossTrajs: 0.94783747     ContextsNorm: 0.02101200     ValIndCrit: 1.03733194
        Saving best model so far ...
    Epoch:  1300      LossTrajs: 1.06671238     ContextsNorm: 0.01958499     ValIndCrit: 1.22894728
    Epoch:  1400      LossTrajs: 1.00253713     ContextsNorm: 0.01765576     ValIndCrit: 1.09092820
    Epoch:  1500      LossTrajs: 0.95903969     ContextsNorm: 0.01761028     ValIndCrit: 1.04413724
    Epoch:  1600      LossTrajs: 0.96104437     ContextsNorm: 0.01749628     ValIndCrit: 1.04852247
    Epoch:  1700      LossTrajs: 0.95158684     ContextsNorm: 0.01742085     ValIndCrit: 1.04019284
    Epoch:  1800      LossTrajs: 0.95181280     ContextsNorm: 0.01714203     ValIndCrit: 1.03920686
    Epoch:  1900      LossTrajs: 0.96169180     ContextsNorm: 0.01698131     ValIndCrit: 1.05148053
    Epoch:  2000      LossTrajs: 1.52748477     ContextsNorm: 0.01641412     ValIndCrit: 2.37588620
    Epoch:  2100      LossTrajs: 1.41899121     ContextsNorm: 0.01668678     ValIndCrit: 1.66095197
    Epoch:  2200      LossTrajs: 1.15612531     ContextsNorm: 0.01682607     ValIndCrit: 1.34199584
    Epoch:  2300      LossTrajs: 1.05500329     ContextsNorm: 0.01686898     ValIndCrit: 1.18579519
    Epoch:  2400      LossTrajs: 0.98617625     ContextsNorm: 0.01673379     ValIndCrit: 1.10132599
    Epoch:  2500      LossTrajs: 0.97229892     ContextsNorm: 0.01667002     ValIndCrit: 1.06765807
    Epoch:  2600      LossTrajs: 0.95912755     ContextsNorm: 0.01660413     ValIndCrit: 1.05263078
    Epoch:  2700      LossTrajs: 0.95616388     ContextsNorm: 0.01654290     ValIndCrit: 1.04642296
    Epoch:  2800      LossTrajs: 0.95378011     ContextsNorm: 0.01649274     ValIndCrit: 1.04392922
    Epoch:  2900      LossTrajs: 0.95267802     ContextsNorm: 0.01649402     ValIndCrit: 1.04293203
    Epoch:  3000      LossTrajs: 0.95157897     ContextsNorm: 0.01647073     ValIndCrit: 1.04257739
    Epoch:  3100      LossTrajs: 0.95183146     ContextsNorm: 0.01641959     ValIndCrit: 1.04236877
    Epoch:  3200      LossTrajs: 0.95152098     ContextsNorm: 0.01638789     ValIndCrit: 1.04232776
    Epoch:  3300      LossTrajs: 0.95126092     ContextsNorm: 0.01634970     ValIndCrit: 1.04231131
    Epoch:  3400      LossTrajs: 0.95226604     ContextsNorm: 0.01630791     ValIndCrit: 1.04225457
    Epoch:  3500      LossTrajs: 0.95087290     ContextsNorm: 0.01627141     ValIndCrit: 1.04228497
    Epoch:  3600      LossTrajs: 0.95170689     ContextsNorm: 0.01623100     ValIndCrit: 1.04210293
    Epoch:  3700      LossTrajs: 0.95036030     ContextsNorm: 0.01623493     ValIndCrit: 1.04194915
    Epoch:  3800      LossTrajs: 0.95159113     ContextsNorm: 0.01619298     ValIndCrit: 1.04191470
    Epoch:  3900      LossTrajs: 0.95184964     ContextsNorm: 0.01607139     ValIndCrit: 1.04179931
    Epoch:  4000      LossTrajs: 0.95188975     ContextsNorm: 0.01605033     ValIndCrit: 1.04194033
    Epoch:  4100      LossTrajs: 0.95174992     ContextsNorm: 0.01602892     ValIndCrit: 1.04186630
    Epoch:  4200      LossTrajs: 0.95130336     ContextsNorm: 0.01598662     ValIndCrit: 1.04170883
    Epoch:  4300      LossTrajs: 0.95127690     ContextsNorm: 0.01593634     ValIndCrit: 1.04151332
    Epoch:  4400      LossTrajs: 0.95157647     ContextsNorm: 0.01584749     ValIndCrit: 1.04189277
    Epoch:  4500      LossTrajs: 0.95080364     ContextsNorm: 0.01581221     ValIndCrit: 1.04147816
    Epoch:  4600      LossTrajs: 0.95138788     ContextsNorm: 0.01576011     ValIndCrit: 1.04136157
    Epoch:  4700      LossTrajs: 0.95122707     ContextsNorm: 0.01573253     ValIndCrit: 1.04247379
    Epoch:  4800      LossTrajs: 0.95082635     ContextsNorm: 0.01581309     ValIndCrit: 1.04139924
    Epoch:  4900      LossTrajs: 0.95010400     ContextsNorm: 0.01577323     ValIndCrit: 1.04116905
    Epoch:  5000      LossTrajs: 0.95014393     ContextsNorm: 0.01580923     ValIndCrit: 1.04125834
    Epoch:  5100      LossTrajs: 0.95103580     ContextsNorm: 0.01582559     ValIndCrit: 1.04122055
    Epoch:  5200      LossTrajs: 0.94993490     ContextsNorm: 0.01580150     ValIndCrit: 1.04090190
    Epoch:  5300      LossTrajs: 0.95075828     ContextsNorm: 0.01579533     ValIndCrit: 1.04096925
    Epoch:  5400      LossTrajs: 0.95038211     ContextsNorm: 0.01575852     ValIndCrit: 1.04084063
    Epoch:  5500      LossTrajs: 0.95161200     ContextsNorm: 0.01574159     ValIndCrit: 1.04275429
    Epoch:  5600      LossTrajs: 0.95066941     ContextsNorm: 0.01578571     ValIndCrit: 1.04127109
    Epoch:  5700      LossTrajs: 0.94990534     ContextsNorm: 0.01575459     ValIndCrit: 1.04070354
    Epoch:  5800      LossTrajs: 0.95061105     ContextsNorm: 0.01573848     ValIndCrit: 1.04046309
    Epoch:  5900      LossTrajs: 0.95004040     ContextsNorm: 0.01580954     ValIndCrit: 1.04044986
    Epoch:  6000      LossTrajs: 0.95002669     ContextsNorm: 0.01577851     ValIndCrit: 1.04036140
    Epoch:  6100      LossTrajs: 0.94988769     ContextsNorm: 0.01570166     ValIndCrit: 1.04050410
    Epoch:  6200      LossTrajs: 0.94971812     ContextsNorm: 0.01572576     ValIndCrit: 1.04017961
    Epoch:  6300      LossTrajs: 0.94982719     ContextsNorm: 0.01568861     ValIndCrit: 1.04000962
    Epoch:  6400      LossTrajs: 0.94967431     ContextsNorm: 0.01560716     ValIndCrit: 1.03999567
    Epoch:  6500      LossTrajs: 0.94959819     ContextsNorm: 0.01558254     ValIndCrit: 1.04003143
    Epoch:  6600      LossTrajs: 0.95033574     ContextsNorm: 0.01557506     ValIndCrit: 1.04170406
    Epoch:  6700      LossTrajs: 0.94933271     ContextsNorm: 0.01562020     ValIndCrit: 1.03963542
    Epoch:  6800      LossTrajs: 0.94806051     ContextsNorm: 0.01565957     ValIndCrit: 1.03959656
    Epoch:  6900      LossTrajs: 0.94903731     ContextsNorm: 0.01561850     ValIndCrit: 1.03954256
    Epoch:  7000      LossTrajs: 0.96113968     ContextsNorm: 0.01584903     ValIndCrit: 1.05769956
    Epoch:  7100      LossTrajs: 1.00292277     ContextsNorm: 0.01598104     ValIndCrit: 1.12198174
    Epoch:  7200      LossTrajs: 0.95004988     ContextsNorm: 0.01599188     ValIndCrit: 1.04053998
