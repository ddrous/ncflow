
############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: train
 Savepath: ./runs/04042024-184552/
 Seed: 2026


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: test
 Savepath: ./runs/04042024-184552/
 Seed: 4052


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.14
Available devices: [gpu(id=0)]
Run folder created successfuly: ./runs/04042024-184552/
Completed copied scripts 
WARNING: You did not provide a dataloader id. A new one has been generated: 184559
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: You did not provide a dataloader id. A new one has been generated: 184559
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.


Total number of parameters in the model: 131149 


WARNING: No key provided for the context initialization. Initializing at 0.
WARNING: No key provided, using time as seed


=== Beginning training with proximal alternating minimization ... ===
    Number of examples in a batch: 32
    Maximum number of steps per inner minimization: 10
    Maximum number of outer minimizations: 1000
    Maximum total number of training steps: 10000

Compiling function "train_step" for neural ode ...
Shapes of elements in a batch: (9, 32, 20, 7) (20,)

Compiling function "train_step" for context ...
Shapes of elements in a batch: (9, 32, 20, 7) (20,)
    Outer Step:     0      LossTrajs: 0.32994244     ContextsNorm: 0.00000000     ValIndCrit: 0.27413481
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    1
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 3.10e-04
        -DiffCxt:  inf
    Outer Step:     1      LossTrajs: 0.25604969     ContextsNorm: 0.00119979     ValIndCrit: 0.22308809
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.53e-04
        -DiffCxt:  1.83e-02
    Outer Step:     2      LossTrajs: 0.20772465     ContextsNorm: 0.00118576     ValIndCrit: 0.21317373
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 5.25e-05
        -DiffCxt:  3.72e-03
    Outer Step:     3      LossTrajs: 0.18713656     ContextsNorm: 0.00116080     ValIndCrit: 0.20051445
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 4.59e-05
        -DiffCxt:  3.51e-03
    Outer Step:    10      LossTrajs: 0.07452568     ContextsNorm: 0.00110401     ValIndCrit: 0.07596125
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.89e-05
        -DiffCxt:  3.43e-03
    Outer Step:    20      LossTrajs: 0.02356973     ContextsNorm: 0.01058231     ValIndCrit: 0.02646977
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.56e-05
        -DiffCxt:  3.31e-04
    Outer Step:    30      LossTrajs: 0.01038824     ContextsNorm: 0.01124620     ValIndCrit: 0.01595421
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.70e-06
        -DiffCxt:  1.57e-04
    Outer Step:    40      LossTrajs: 0.00640758     ContextsNorm: 0.01199469     ValIndCrit: 0.01197997
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.93e-06
        -DiffCxt:  7.39e-05
    Outer Step:    50      LossTrajs: 0.00493209     ContextsNorm: 0.01308321     ValIndCrit: 0.01023437
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.30e-06
        -DiffCxt:  8.18e-06
    Outer Step:    60      LossTrajs: 0.00408409     ContextsNorm: 0.01359050     ValIndCrit: 0.00905247
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 5.56e-07
        -DiffCxt:  1.30e-05
    Outer Step:    70      LossTrajs: 0.00364684     ContextsNorm: 0.01432924     ValIndCrit: 0.00815293
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.11e-06
        -DiffCxt:  3.00e-05
    Outer Step:    80      LossTrajs: 0.00305720     ContextsNorm: 0.01464167     ValIndCrit: 0.00772872
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 9.19e-07
        -DiffCxt:  7.62e-06
    Outer Step:    90      LossTrajs: 0.00352090     ContextsNorm: 0.01446392     ValIndCrit: 0.00727953
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 7.44e-06
        -DiffCxt:  4.64e-05
    Outer Step:   100      LossTrajs: 0.00265291     ContextsNorm: 0.01445621     ValIndCrit: 0.00696842
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.08e-06
        -DiffCxt:  1.17e-05
    Outer Step:   110      LossTrajs: 0.00252874     ContextsNorm: 0.01466946     ValIndCrit: 0.00666613
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.23e-06
        -DiffCxt:  1.09e-05
    Outer Step:   120      LossTrajs: 0.00220433     ContextsNorm: 0.01454235     ValIndCrit: 0.00642201
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.40e-06
        -DiffCxt:  4.90e-05
    Outer Step:   130      LossTrajs: 0.00181232     ContextsNorm: 0.01466707     ValIndCrit: 0.00606403
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.67e-07
        -DiffCxt:  6.70e-06
    Outer Step:   140      LossTrajs: 0.00215111     ContextsNorm: 0.01498329     ValIndCrit: 0.00609891
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.62e-06
        -DiffCxt:  3.06e-05
    Outer Step:   150      LossTrajs: 0.00166856     ContextsNorm: 0.01535643     ValIndCrit: 0.00611374
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.33e-06
        -DiffCxt:  1.65e-05
    Outer Step:   160      LossTrajs: 0.00204247     ContextsNorm: 0.01470868     ValIndCrit: 0.00675537
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 3.11e-06
        -DiffCxt:  1.35e-04
    Outer Step:   170      LossTrajs: 0.00192992     ContextsNorm: 0.01508797     ValIndCrit: 0.00508695
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 9.58e-07
        -DiffCxt:  9.54e-06
    Outer Step:   180      LossTrajs: 0.00240238     ContextsNorm: 0.01491082     ValIndCrit: 0.00481174
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 3.46e-06
        -DiffCxt:  1.59e-05
    Outer Step:   190      LossTrajs: 0.00133854     ContextsNorm: 0.01441485     ValIndCrit: 0.00528064
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 6.44e-07
        -DiffCxt:  1.95e-05
    Outer Step:   200      LossTrajs: 0.00136253     ContextsNorm: 0.01406253     ValIndCrit: 0.00476101
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.00e-06
        -DiffCxt:  6.63e-05
    Outer Step:   210      LossTrajs: 0.00119515     ContextsNorm: 0.01407384     ValIndCrit: 0.00458254
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 5.38e-07
        -DiffCxt:  5.12e-06
    Outer Step:   220      LossTrajs: 0.00116404     ContextsNorm: 0.01410246     ValIndCrit: 0.00461403
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 8.32e-07
        -DiffCxt:  1.55e-04
    Outer Step:   230      LossTrajs: 0.00102663     ContextsNorm: 0.01507327     ValIndCrit: 0.00423681
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.46e-07
        -DiffCxt:  2.85e-06
    Outer Step:   240      LossTrajs: 0.00116624     ContextsNorm: 0.01541095     ValIndCrit: 0.00414564
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 7.11e-07
        -DiffCxt:  1.13e-05
    Outer Step:   250      LossTrajs: 0.00122387     ContextsNorm: 0.01554087     ValIndCrit: 0.00461880
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.42e-05
        -DiffCxt:  2.16e-04
    Outer Step:   260      LossTrajs: 0.00150200     ContextsNorm: 0.01528553     ValIndCrit: 0.00411056
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 3.93e-06
        -DiffCxt:  5.01e-05
    Outer Step:   270      LossTrajs: 0.00086468     ContextsNorm: 0.01517798     ValIndCrit: 0.00396676
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    9
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 7.93e-08
        -DiffCxt:  1.28e-06
    Outer Step:   280      LossTrajs: 0.00084804     ContextsNorm: 0.01520517     ValIndCrit: 0.00393316
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 4.70e-08
        -DiffCxt:  2.29e-06
    Outer Step:   290      LossTrajs: 0.00179706     ContextsNorm: 0.01531991     ValIndCrit: 0.00446615
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 3.83e-06
        -DiffCxt:  1.20e-04
    Outer Step:   300      LossTrajs: 0.00082317     ContextsNorm: 0.01519621     ValIndCrit: 0.00376202
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 6.63e-07
        -DiffCxt:  8.16e-06
    Outer Step:   310      LossTrajs: 0.00176563     ContextsNorm: 0.01541193     ValIndCrit: 0.00440695
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 3.67e-06
        -DiffCxt:  1.11e-04
    Outer Step:   320      LossTrajs: 0.00074885     ContextsNorm: 0.01552263     ValIndCrit: 0.00329487
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    1
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 8.24e-08
        -DiffCxt:  1.99e-06
    Outer Step:   330      LossTrajs: 0.00072168     ContextsNorm: 0.01550150     ValIndCrit: 0.00327599
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    3
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 5.45e-08
        -DiffCxt:  1.50e-06
    Outer Step:   340      LossTrajs: 0.00074146     ContextsNorm: 0.01548234     ValIndCrit: 0.00327313
        -NbInnerStepsNode:    2
        -NbInnerStepsCxt:    8
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 8.18e-08
        -DiffCxt:  2.00e-06
    Outer Step:   350      LossTrajs: 0.00338851     ContextsNorm: 0.01485322     ValIndCrit: 0.00425953
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 7.85e-06
        -DiffCxt:  1.10e-04
    Outer Step:   360      LossTrajs: 0.00127329     ContextsNorm: 0.01458570     ValIndCrit: 0.00413971
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.61e-06
        -DiffCxt:  2.56e-05
    Outer Step:   370      LossTrajs: 0.00067041     ContextsNorm: 0.01461081     ValIndCrit: 0.00315637
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 5.70e-08
        -DiffCxt:  3.73e-06
    Outer Step:   380      LossTrajs: 0.00066231     ContextsNorm: 0.01466058     ValIndCrit: 0.00309878
        -NbInnerStepsNode:    2
        -NbInnerStepsCxt:    8
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 7.39e-08
        -DiffCxt:  1.89e-06
    Outer Step:   390      LossTrajs: 0.00067446     ContextsNorm: 0.01439430     ValIndCrit: 0.00300468
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 4.03e-07
        -DiffCxt:  8.28e-06
    Outer Step:   400      LossTrajs: 0.00061734     ContextsNorm: 0.01461922     ValIndCrit: 0.00293238
        -NbInnerStepsNode:    5
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 9.03e-08
        -DiffCxt:  6.48e-06
    Outer Step:   410      LossTrajs: 0.00083422     ContextsNorm: 0.01469515     ValIndCrit: 0.00326091
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.19e-06
        -DiffCxt:  1.30e-05
    Outer Step:   420      LossTrajs: 0.00205901     ContextsNorm: 0.01517976     ValIndCrit: 0.00343022
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 3.21e-06
        -DiffCxt:  2.55e-04
    Outer Step:   430      LossTrajs: 0.00097306     ContextsNorm: 0.01542397     ValIndCrit: 0.00369410
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.63e-06
        -DiffCxt:  2.87e-05
    Outer Step:   440      LossTrajs: 0.00052096     ContextsNorm: 0.01559815     ValIndCrit: 0.00281768
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 9.09e-08
        -DiffCxt:  4.33e-06
    Outer Step:   450      LossTrajs: 0.00050141     ContextsNorm: 0.01553626     ValIndCrit: 0.00283526
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    3
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 5.89e-08
        -DiffCxt:  1.65e-06
    Outer Step:   460      LossTrajs: 0.00058192     ContextsNorm: 0.01582742     ValIndCrit: 0.00271326
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 5.49e-07
        -DiffCxt:  1.22e-05
    Outer Step:   470      LossTrajs: 0.00056163     ContextsNorm: 0.01592752     ValIndCrit: 0.00285668
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.14e-06
        -DiffCxt:  1.41e-05
    Outer Step:   480      LossTrajs: 0.00044163     ContextsNorm: 0.01596137     ValIndCrit: 0.00261200
        -NbInnerStepsNode:    4
        -NbInnerStepsCxt:    4
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 9.36e-08
        -DiffCxt:  1.73e-06
    Outer Step:   490      LossTrajs: 0.00042864     ContextsNorm: 0.01588784     ValIndCrit: 0.00254378
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    3
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 5.98e-08
        -DiffCxt:  1.67e-06
    Outer Step:   500      LossTrajs: 0.00040979     ContextsNorm: 0.01575199     ValIndCrit: 0.00258224
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 9.43e-08
        -DiffCxt:  5.68e-06
    Outer Step:   510      LossTrajs: 0.00052829     ContextsNorm: 0.01584043     ValIndCrit: 0.00260572
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 3.15e-07
        -DiffCxt:  6.31e-06
    Outer Step:   520      LossTrajs: 0.00040235     ContextsNorm: 0.01566895     ValIndCrit: 0.00281128
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    4
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 8.02e-08
        -DiffCxt:  1.24e-06
    Outer Step:   530      LossTrajs: 0.00040098     ContextsNorm: 0.01560451     ValIndCrit: 0.00258017
        -NbInnerStepsNode:    4
        -NbInnerStepsCxt:    1
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 8.18e-08
        -DiffCxt:  1.74e-06
    Outer Step:   540      LossTrajs: 0.00039678     ContextsNorm: 0.01563229     ValIndCrit: 0.00248105
        -NbInnerStepsNode:    2
        -NbInnerStepsCxt:    1
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 7.36e-08
        -DiffCxt:  1.61e-06
    Outer Step:   550      LossTrajs: 0.00102693     ContextsNorm: 0.01584043     ValIndCrit: 0.00279877
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 8.53e-07
        -DiffCxt:  2.47e-05
    Outer Step:   560      LossTrajs: 0.00037522     ContextsNorm: 0.01574794     ValIndCrit: 0.00303786
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.70e-07
        -DiffCxt:  5.96e-06
    Outer Step:   570      LossTrajs: 0.00036434     ContextsNorm: 0.01611560     ValIndCrit: 0.00236454
        -NbInnerStepsNode:    2
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 8.05e-08
        -DiffCxt:  9.52e-07
    Outer Step:   580      LossTrajs: 0.00034798     ContextsNorm: 0.01608528     ValIndCrit: 0.00237222
        -NbInnerStepsNode:    5
        -NbInnerStepsCxt:    3
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 7.05e-08
        -DiffCxt:  1.22e-06
    Outer Step:   590      LossTrajs: 0.00033514     ContextsNorm: 0.01594749     ValIndCrit: 0.00259234
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.34e-07
        -DiffCxt:  2.24e-05
    Outer Step:   600      LossTrajs: 0.00046088     ContextsNorm: 0.01588983     ValIndCrit: 0.00257474
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 7.29e-07
        -DiffCxt:  9.36e-06
    Outer Step:   610      LossTrajs: 0.00066711     ContextsNorm: 0.01589004     ValIndCrit: 0.00313531
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.34e-06
        -DiffCxt:  5.85e-06
    Outer Step:   620      LossTrajs: 0.00030748     ContextsNorm: 0.01587998     ValIndCrit: 0.00235458
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    3
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 7.78e-08
        -DiffCxt:  6.91e-07
    Outer Step:   630      LossTrajs: 0.00049336     ContextsNorm: 0.01575163     ValIndCrit: 0.00262250
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 7.36e-07
        -DiffCxt:  5.92e-06
    Outer Step:   640      LossTrajs: 0.00043300     ContextsNorm: 0.01634105     ValIndCrit: 0.00240827
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.37e-07
        -DiffCxt:  9.06e-06
    Outer Step:   650      LossTrajs: 0.00028592     ContextsNorm: 0.01578183     ValIndCrit: 0.00227980
        -NbInnerStepsNode:    2
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 7.59e-08
        -DiffCxt:  1.66e-06
    Outer Step:   660      LossTrajs: 0.00030268     ContextsNorm: 0.01560361     ValIndCrit: 0.00234341
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 3.37e-07
        -DiffCxt:  6.78e-06
    Outer Step:   670      LossTrajs: 0.00050946     ContextsNorm: 0.01588987     ValIndCrit: 0.00284735
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.89e-06
        -DiffCxt:  3.67e-05
    Outer Step:   680      LossTrajs: 0.00026617     ContextsNorm: 0.01565745     ValIndCrit: 0.00231489
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    1
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 6.74e-08
        -DiffCxt:  1.67e-06
    Outer Step:   690      LossTrajs: 0.00026215     ContextsNorm: 0.01564695     ValIndCrit: 0.00225791
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    8
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 5.03e-08
        -DiffCxt:  1.85e-06
    Outer Step:   700      LossTrajs: 0.00025689     ContextsNorm: 0.01551954     ValIndCrit: 0.00224245
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    3
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 8.75e-08
        -DiffCxt:  1.63e-06
    Outer Step:   710      LossTrajs: 0.00047992     ContextsNorm: 0.01574038     ValIndCrit: 0.00259431
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.88e-06
        -DiffCxt:  2.35e-05
    Outer Step:   720      LossTrajs: 0.00024351     ContextsNorm: 0.01556690     ValIndCrit: 0.00220498
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    2
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 7.22e-08
        -DiffCxt:  1.74e-06
    Outer Step:   730      LossTrajs: 0.00023823     ContextsNorm: 0.01551715     ValIndCrit: 0.00217151
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    3
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 3.28e-08
        -DiffCxt:  1.25e-06
    Outer Step:   740      LossTrajs: 0.00023858     ContextsNorm: 0.01561663     ValIndCrit: 0.00218164
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    4
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 6.25e-08
        -DiffCxt:  1.02e-06
    Outer Step:   750      LossTrajs: 0.00023553     ContextsNorm: 0.01561667     ValIndCrit: 0.00217193
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    4
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 4.47e-08
        -DiffCxt:  1.21e-06
    Outer Step:   760      LossTrajs: 0.00022952     ContextsNorm: 0.01568610     ValIndCrit: 0.00220805
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    3
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 6.50e-08
        -DiffCxt:  1.49e-06
    Outer Step:   770      LossTrajs: 0.00039273     ContextsNorm: 0.01573636     ValIndCrit: 0.00229168
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 7.28e-07
        -DiffCxt:  2.00e-05
    Outer Step:   780      LossTrajs: 0.00023430     ContextsNorm: 0.01551741     ValIndCrit: 0.00219247
        -NbInnerStepsNode:    2
        -NbInnerStepsCxt:    1
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 9.77e-08
        -DiffCxt:  1.69e-06
    Outer Step:   790      LossTrajs: 0.00022676     ContextsNorm: 0.01554465     ValIndCrit: 0.00215084
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    3
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 4.78e-08
        -DiffCxt:  1.52e-06
    Outer Step:   800      LossTrajs: 0.00023186     ContextsNorm: 0.01555930     ValIndCrit: 0.00211824
        -NbInnerStepsNode:    8
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 6.69e-08
        -DiffCxt:  3.69e-06
    Outer Step:   810      LossTrajs: 0.00021421     ContextsNorm: 0.01539153     ValIndCrit: 0.00211539
        -NbInnerStepsNode:    4
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 5.44e-08
        -DiffCxt:  2.75e-06
    Outer Step:   820      LossTrajs: 0.00035231     ContextsNorm: 0.01569965     ValIndCrit: 0.00262147
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 9.43e-07
        -DiffCxt:  1.51e-05
    Outer Step:   830      LossTrajs: 0.00023537     ContextsNorm: 0.01584629     ValIndCrit: 0.00236518
        -NbInnerStepsNode:    5
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 8.78e-08
        -DiffCxt:  2.15e-06
    Outer Step:   840      LossTrajs: 0.00021589     ContextsNorm: 0.01580123     ValIndCrit: 0.00222357
        -NbInnerStepsNode:    7
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 8.11e-08
        -DiffCxt:  4.91e-06
    Outer Step:   850      LossTrajs: 0.00022743     ContextsNorm: 0.01576345     ValIndCrit: 0.00249706
        -NbInnerStepsNode:    9
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 6.46e-08
        -DiffCxt:  8.73e-06
    Outer Step:   860      LossTrajs: 0.00032757     ContextsNorm: 0.01588865     ValIndCrit: 0.00285088
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 5.22e-07
        -DiffCxt:  2.83e-06
    Outer Step:   870      LossTrajs: 0.00026361     ContextsNorm: 0.01598642     ValIndCrit: 0.00262309
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 6.78e-07
        -DiffCxt:  1.04e-05
    Outer Step:   880      LossTrajs: 0.00021214     ContextsNorm: 0.01587793     ValIndCrit: 0.00226582
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    3
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 7.75e-08
        -DiffCxt:  1.76e-06
    Outer Step:   890      LossTrajs: 0.00019863     ContextsNorm: 0.01593103     ValIndCrit: 0.00220577
        -NbInnerStepsNode:    3
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 6.29e-08
        -DiffCxt:  2.92e-06
    Outer Step:   900      LossTrajs: 0.00020571     ContextsNorm: 0.01617273     ValIndCrit: 0.00220415
        -NbInnerStepsNode:    5
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 7.55e-08
        -DiffCxt:  8.93e-06
    Outer Step:   910      LossTrajs: 0.00019732     ContextsNorm: 0.01618623     ValIndCrit: 0.00226365
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    4
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 9.04e-08
        -DiffCxt:  1.88e-06
    Outer Step:   920      LossTrajs: 0.00018375     ContextsNorm: 0.01624766     ValIndCrit: 0.00212238
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    3
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 8.22e-08
        -DiffCxt:  1.53e-06
    Outer Step:   930      LossTrajs: 0.00019217     ContextsNorm: 0.01608720     ValIndCrit: 0.00218775
        -NbInnerStepsNode:    3
        -NbInnerStepsCxt:    7
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 7.71e-08
        -DiffCxt:  1.40e-06
    Outer Step:   940      LossTrajs: 0.00029986     ContextsNorm: 0.01601261     ValIndCrit: 0.00235983
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.35e-06
        -DiffCxt:  1.66e-05
    Outer Step:   950      LossTrajs: 0.00034271     ContextsNorm: 0.01572843     ValIndCrit: 0.00290812
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.01e-06
        -DiffCxt:  2.04e-05
    Outer Step:   960      LossTrajs: 0.00017685     ContextsNorm: 0.01575900     ValIndCrit: 0.00243472
        -NbInnerStepsNode:    2
        -NbInnerStepsCxt:    7
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 8.50e-08
        -DiffCxt:  1.89e-06
    Outer Step:   970      LossTrajs: 0.00036900     ContextsNorm: 0.01570369     ValIndCrit: 0.00290220
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.76e-06
        -DiffCxt:  2.18e-05
    Outer Step:   980      LossTrajs: 0.00034739     ContextsNorm: 0.01617508     ValIndCrit: 0.00284220
        -NbInnerStepsNode:   10
        -NbInnerStepsCxt:   10
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.73e-06
        -DiffCxt:  7.22e-05
    Outer Step:   990      LossTrajs: 0.00016131     ContextsNorm: 0.01619757     ValIndCrit: 0.00254906
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    2
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 3.72e-08
        -DiffCxt:  9.40e-07
    Outer Step:   999      LossTrajs: 0.00015848     ContextsNorm: 0.01630643     ValIndCrit: 0.00253070
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    3
        -InnerToleranceNode: 1.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 4.95e-08
        -DiffCxt:  1.52e-06

Total gradient descent training time: 4 hours 17 mins 35 secs
Environment weights at the end of the training: [0.11111111 0.11111111 0.11111111 0.11111111 0.11111111 0.11111111
 0.11111111 0.11111111 0.11111111]
WARNING: You did not provide a dataloader id. A new one has been generated: 230350
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: No key provided, using time as seed
==  Begining in-domain testing ... ==
    Number of training environments: 9
    Final length of the training trajectories: 20
    Length of the testing trajectories: 20
Test Score (In-Domain): 0.0025306982

==  Begining in-domain visualisation ... ==
    Environment id: 8
    Trajectory id: 17
    Visualized dimensions: (0, 1)
    Final length of the training trajectories: 20
    Length of the testing trajectories: 20
Testing finished. Figure saved in: ./runs/04042024-184552/results_in_domain.png
Traceback (most recent call last):
  File "/lustre/home/br-rnzoyem/Projects/Nodax/examples/glycolytic-oscillator/main_T2.py", line 379, in <module>
    adapt_dataloader = DataLoader(adapt_folder+"adapt_data.npz", adaptation=True, data_id="170846", key=seed)
  File "/lustre/home/br-rnzoyem/Projects/Nodax/nodax/dataloader.py", line 12, in __init__
    raw_dat = jnp.load(dataset)
  File "/lustre/home/br-rnzoyem/Projects/GraphPint/venv/lib/python3.9/site-packages/jax/_src/numpy/lax_numpy.py", line 286, in load
    out = np.load(*args, **kwargs)
  File "/lustre/home/br-rnzoyem/Projects/GraphPint/venv/lib/python3.9/site-packages/numpy/lib/npyio.py", line 427, in load
    fid = stack.enter_context(open(os_fspath(file), "rb"))
FileNotFoundError: [Errno 2] No such file or directory: './runs/04042024-184552/adapt/adapt_data.npz'
