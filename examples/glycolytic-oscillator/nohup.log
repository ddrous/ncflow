
############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: train
 Savepath: ./runs/09032024-071039/
 Seed: 2026


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: test
 Savepath: ./runs/09032024-071039/
 Seed: 4052


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]
Run folder created successfuly: ./runs/09032024-071039/
Completed copied scripts 
WARNING: You did not provide a dataloader id. A new one has been generated: 071052
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: You did not provide a dataloader id. A new one has been generated: 071052
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.


Total number of parameters in the model: 400525 


WARNING: No key provided for the context initialization. Initializing at 0.
WARNING: No key provided, using time as seed


=== Beginning training with proximal alternating minimization ... ===
    Number of examples in a batch: 32
    Maximum number of steps per inner minimization: 20
    Maximum number of outer minimizations: 288
    Maximum total number of training steps: 5760

Compiling function "train_step" for neural ode ...
Shapes of elements in a batch: (9, 32, 20, 7) (20,)

Compiling function "train_step" for context ...
Shapes of elements in a batch: (9, 32, 20, 7) (20,)
    Outer Step:     0      LossTrajs: 0.29561248     ContextsNorm: 0.00000000     ValIndCrit: 0.29771385
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    1
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 3.03e-04
        -DiffCxt:  inf
    Outer Step:     1      LossTrajs: 0.21188794     ContextsNorm: 0.00345001     ValIndCrit: 0.20826165
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.90e-04
        -DiffCxt:  1.49e-03
    Outer Step:     2      LossTrajs: 0.14606902     ContextsNorm: 0.00533817     ValIndCrit: 0.13851629
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 7.23e-05
        -DiffCxt:  7.28e-04
    Outer Step:     3      LossTrajs: 0.11143111     ContextsNorm: 0.01046847     ValIndCrit: 0.10276004
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 4.29e-04
        -DiffCxt:  9.47e-04
    Outer Step:    10      LossTrajs: 0.01133527     ContextsNorm: 0.01041763     ValIndCrit: 0.01408623
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.15e-05
        -DiffCxt:  6.10e-05
    Outer Step:    20      LossTrajs: 0.00496147     ContextsNorm: 0.01089301     ValIndCrit: 0.00699793
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 5.25e-06
        -DiffCxt:  4.54e-05
    Outer Step:    30      LossTrajs: 0.00361572     ContextsNorm: 0.01327450     ValIndCrit: 0.00509155
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.68e-06
        -DiffCxt:  2.86e-05
    Outer Step:    40      LossTrajs: 0.00307577     ContextsNorm: 0.01348205     ValIndCrit: 0.00441770
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 9.87e-07
        -DiffCxt:  8.48e-06
    Outer Step:    50      LossTrajs: 0.00271148     ContextsNorm: 0.01372596     ValIndCrit: 0.00366726
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.29e-06
        -DiffCxt:  7.03e-06
    Outer Step:    60      LossTrajs: 0.00246238     ContextsNorm: 0.01393803     ValIndCrit: 0.00339101
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 5.47e-06
        -DiffCxt:  2.51e-05
    Outer Step:    70      LossTrajs: 0.00200829     ContextsNorm: 0.01456605     ValIndCrit: 0.00299950
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.69e-06
        -DiffCxt:  1.28e-05
    Outer Step:    80      LossTrajs: 0.00179885     ContextsNorm: 0.01479931     ValIndCrit: 0.00268210
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.00e-05
        -DiffCxt:  8.56e-06
    Outer Step:    90      LossTrajs: 0.00150113     ContextsNorm: 0.01355975     ValIndCrit: 0.00246710
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.43e-07
        -DiffCxt:  2.44e-06
    Outer Step:   100      LossTrajs: 0.00150501     ContextsNorm: 0.01367790     ValIndCrit: 0.00245121
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.82e-07
        -DiffCxt:  1.19e-05
    Outer Step:   110      LossTrajs: 0.00148121     ContextsNorm: 0.01373621     ValIndCrit: 0.00250242
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.34e-07
        -DiffCxt:  9.08e-06
    Outer Step:   120      LossTrajs: 0.00172200     ContextsNorm: 0.01471420     ValIndCrit: 0.00257074
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.05e-06
        -DiffCxt:  4.46e-05
    Outer Step:   130      LossTrajs: 0.00159686     ContextsNorm: 0.01479531     ValIndCrit: 0.00264301
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 5.21e-06
        -DiffCxt:  5.14e-05
    Outer Step:   140      LossTrajs: 0.00136480     ContextsNorm: 0.01435342     ValIndCrit: 0.00226340
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.81e-07
        -DiffCxt:  5.10e-06
    Outer Step:   150      LossTrajs: 0.00133752     ContextsNorm: 0.01432057     ValIndCrit: 0.00223942
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.40e-07
        -DiffCxt:  3.24e-06
    Outer Step:   160      LossTrajs: 0.00141253     ContextsNorm: 0.01650561     ValIndCrit: 0.00246192
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.13e-06
        -DiffCxt:  2.39e-05
    Outer Step:   170      LossTrajs: 0.00126290     ContextsNorm: 0.01637631     ValIndCrit: 0.00220433
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.85e-07
        -DiffCxt:  3.04e-06
    Outer Step:   180      LossTrajs: 0.00123914     ContextsNorm: 0.01691325     ValIndCrit: 0.00215242
        -NbInnerStepsNode:   19
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 3.84e-07
        -DiffCxt:  4.84e-06
    Outer Step:   190      LossTrajs: 0.00123741     ContextsNorm: 0.01738938     ValIndCrit: 0.00208386
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.71e-07
        -DiffCxt:  1.05e-05
    Outer Step:   200      LossTrajs: 0.00120726     ContextsNorm: 0.01833051     ValIndCrit: 0.00209951
        -NbInnerStepsNode:    2
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.54e-07
        -DiffCxt:  4.37e-06
    Outer Step:   210      LossTrajs: 0.00119037     ContextsNorm: 0.01831212     ValIndCrit: 0.00207577
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.89e-07
        -DiffCxt:  7.26e-06
    Outer Step:   220      LossTrajs: 0.00116848     ContextsNorm: 0.01800375     ValIndCrit: 0.00206280
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.01e-07
        -DiffCxt:  1.98e-06
    Outer Step:   230      LossTrajs: 0.00115581     ContextsNorm: 0.01812787     ValIndCrit: 0.00205606
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   18
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 2.38e-07
        -DiffCxt:  1.78e-06
    Outer Step:   240      LossTrajs: 0.00115186     ContextsNorm: 0.01802969     ValIndCrit: 0.00201626
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   17
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 3.55e-07
        -DiffCxt:  1.94e-06
    Outer Step:   250      LossTrajs: 0.00116849     ContextsNorm: 0.01858178     ValIndCrit: 0.00204189
        -NbInnerStepsNode:    3
        -NbInnerStepsCxt:   17
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 3.68e-07
        -DiffCxt:  1.48e-06
    Outer Step:   260      LossTrajs: 0.00130406     ContextsNorm: 0.02195749     ValIndCrit: 0.00213392
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 5.87e-06
        -DiffCxt:  1.37e-05
    Outer Step:   270      LossTrajs: 0.00102121     ContextsNorm: 0.02143570     ValIndCrit: 0.00182109
        -NbInnerStepsNode:    7
        -NbInnerStepsCxt:   17
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 3.88e-07
        -DiffCxt:  1.88e-06
    Outer Step:   280      LossTrajs: 0.00090424     ContextsNorm: 0.02126806     ValIndCrit: 0.00169483
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 5.99e-07
        -DiffCxt:  9.29e-06
    Outer Step:   287      LossTrajs: 0.00069667     ContextsNorm: 0.02079489     ValIndCrit: 0.00149088
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   20
        -InnerToleranceNode: 4.00e-07
        -InnerToleranceCtx:  2.00e-06
        -DiffNode: 1.13e-06
        -DiffCxt:  2.25e-05

Total gradient descent training time: 2 hours 51 mins 6 secs
Environment weights at the end of the training: [0.11111111 0.11111111 0.11111111 0.11111111 0.11111111 0.11111111
 0.11111111 0.11111111 0.11111111]
WARNING: You did not provide a dataloader id. A new one has been generated: 100200
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: No key provided, using time as seed
==  Begining in-domain testing ... ==
    Number of training environments: 9
    Final length of the training trajectories: 20
    Length of the testing trajectories: 20
Test Score (In-Domain): 0.0014908792


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: adapt
 Savepath: ./runs/09032024-071039/adapt/
 Seed: 6078

==  Begining in-domain visualisation ... ==
    Environment id: 5
    Trajectory id: 2
    Visualized dimensions: (0, 1)
    Final length of the training trajectories: 20
    Length of the testing trajectories: 20
Testing finished. Figure saved in: ./runs/09032024-071039/results_in_domain.png
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: No key provided for the context initialization. Initializing at 0.


=== Beginning adaptation ... ===
    Number of examples in a batch: 1
    Number of train steps per epoch: 1
    Number of training epochs: 24
    Total number of training steps: 24
WARNING: No key provided, using time as seed

Compiling function "train_step" for context ...
Shapes of elements in a batch: (4, 1, 20, 7) (20,)
    Epoch:     0     LossContext: 0.01426864
    Epoch:     1     LossContext: 0.01220853
    Epoch:     2     LossContext: 0.01030131
    Epoch:     3     LossContext: 0.00859999
    Epoch:    10     LossContext: 0.00231367
    Epoch:    20     LossContext: 0.00107348
    Epoch:    23     LossContext: 0.00104103

Total gradient descent adaptation time: 0 hours 0 mins 9 secs
Environment weights at the end of the adaptation: [0.25 0.25 0.25 0.25]

Saving adaptation parameters into ./runs/09032024-071039/adapt/ folder with id 170846 ...

==  Begining out-of-distribution testing ... ==
    Number of training environments: 9
    Number of adaptation environments: 4
    Final length of the training trajectories: 20
    Length of the testing trajectories: 20
Test Score (OOD): 0.0009783091

==  Begining out-of-distribution visualisation ... ==
    Environment id: 1
    Trajectory id: 0
    Visualized dimensions: (0, 1)
    Final length of the training trajectories: 20
    Length of the testing trajectories: 20
Testing finished. Figure saved in: ./runs/09032024-071039/adapt/results_ood.png

Full evaluation of the model on 10 random seeds


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]

############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]


Mean and std of the scores across various datasets

          seed  ind_crit  ood_crit
count 1.00e+01  1.00e+01  1.00e+01
mean  5.25e+03  1.33e-03  1.46e-03
std   3.39e+03  2.25e-04  3.53e-04
