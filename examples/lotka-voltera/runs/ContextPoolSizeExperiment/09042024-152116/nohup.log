
############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: train
 Savepath: ./09042024-152116/
 Seed: 2026


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: test
 Savepath: ./09042024-152116/
 Seed: 4052


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]
Run folder created successfuly: ./09042024-152116/
Completed copied scripts 
WARNING: You did not provide a dataloader id. A new one has been generated: 152120
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: You did not provide a dataloader id. A new one has been generated: 152120
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.


Total number of parameters in the model: 308240 


WARNING: No key provided for the context initialization. Initializing at 0.
WARNING: No key provided, using time as seed


=== Beginning training with proximal alternating minimization ... ===
    Number of examples in a batch: 4
    Maximum number of steps per inner minimization: 25
    Maximum number of outer minimizations: 1500
    Maximum total number of training steps: 37500

Compiling function "train_step" for neural ode ...
Shapes of elements in a batch: (9, 4, 20, 2) (20,)

Compiling function "train_step" for context ...
Shapes of elements in a batch: (9, 4, 20, 2) (20,)
    Outer Step:     0      LossTrajs: 1.81636751     ContextsNorm: 0.00000000     ValIndCrit: 1.70389903
        Saving best model so far ...
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    1
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 1.71e-06
        -DiffCxt:  inf
    Outer Step:     1      LossTrajs: 1.53356862     ContextsNorm: 0.00133134     ValIndCrit: 1.43725932
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 1.67e-06
        -DiffCxt:  5.62e-04
    Outer Step:     2      LossTrajs: 1.23032498     ContextsNorm: 0.00392259     ValIndCrit: 1.14924717
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 1.11e-05
        -DiffCxt:  7.08e-04
    Outer Step:     3      LossTrajs: 0.81609696     ContextsNorm: 0.00775006     ValIndCrit: 0.75058144
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 3.19e-05
        -DiffCxt:  3.82e-04
    Outer Step:   100      LossTrajs: 0.00342245     ContextsNorm: 0.01903399     ValIndCrit: 0.00542783
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 1.35e-07
        -DiffCxt:  4.22e-07
    Outer Step:   200      LossTrajs: 0.00056838     ContextsNorm: 0.02243277     ValIndCrit: 0.00095466
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 7.85e-08
        -DiffCxt:  1.33e-07
    Outer Step:   300      LossTrajs: 0.00015180     ContextsNorm: 0.02244991     ValIndCrit: 0.00025773
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 7.77e-08
        -DiffCxt:  1.98e-07
    Outer Step:   400      LossTrajs: 0.00009113     ContextsNorm: 0.02226462     ValIndCrit: 0.00015174
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 1.19e-07
        -DiffCxt:  1.27e-07
    Outer Step:   500      LossTrajs: 0.00006104     ContextsNorm: 0.02300437     ValIndCrit: 0.00014543
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 1.61e-07
        -DiffCxt:  3.07e-07
    Outer Step:   600      LossTrajs: 0.00008426     ContextsNorm: 0.02251776     ValIndCrit: 0.00011169
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 1.70e-07
        -DiffCxt:  2.56e-07
    Outer Step:   700      LossTrajs: 0.00005769     ContextsNorm: 0.02209646     ValIndCrit: 0.00008049
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 9.31e-08
        -DiffCxt:  4.55e-07
    Outer Step:   800      LossTrajs: 0.00004952     ContextsNorm: 0.02173536     ValIndCrit: 0.00006962
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 2.17e-08
        -DiffCxt:  3.31e-07
    Outer Step:   900      LossTrajs: 0.00007708     ContextsNorm: 0.02137241     ValIndCrit: 0.00006927
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 3.06e-07
        -DiffCxt:  3.40e-07
    Outer Step:  1000      LossTrajs: 0.00005137     ContextsNorm: 0.02045910     ValIndCrit: 0.00006781
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 8.17e-08
        -DiffCxt:  3.51e-07
    Outer Step:  1100      LossTrajs: 0.00004072     ContextsNorm: 0.01994253     ValIndCrit: 0.00007064
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 2.78e-07
        -DiffCxt:  6.34e-07
    Outer Step:  1200      LossTrajs: 0.00003383     ContextsNorm: 0.01968787     ValIndCrit: 0.00005699
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 2.41e-08
        -DiffCxt:  3.36e-07
    Outer Step:  1300      LossTrajs: 0.00004056     ContextsNorm: 0.01868158     ValIndCrit: 0.00005849
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 2.19e-08
        -DiffCxt:  1.39e-07
    Outer Step:  1400      LossTrajs: 0.00003901     ContextsNorm: 0.01816025     ValIndCrit: 0.00005225
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 6.63e-08
        -DiffCxt:  5.10e-07
    Outer Step:  1499      LossTrajs: 0.00003940     ContextsNorm: 0.01767140     ValIndCrit: 0.00007438
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 1.04e-07
        -DiffCxt:  4.16e-07

Total gradient descent training time: 0 hours 51 mins 21 secs
Environment weights at the end of the training: [0.11111111 0.11111111 0.11111111 0.11111111 0.11111111 0.11111111
 0.11111111 0.11111111 0.11111111]
WARNING: You did not provide a dataloader id. A new one has been generated: 161243
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: No key provided, using time as seed
==  Begining in-domain testing ... ==
    Number of training environments: 9
    Final length of the training trajectories: 20
    Length of the testing trajectories: 20
Test Score (In-Domain): 5.224747e-05


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: adapt
 Savepath: ./09042024-152116/adapt/
 Seed: 6078


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: adapt_test
 Savepath: ./09042024-152116/adapt/
 Seed: 6078

WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.

==================== Sequential adaptation ====================


=== Beginning sequential adaptation ... ===
    Number of examples in a batch: 1
    Number of train steps per epoch: 1
    Number of training epochs: 15
    Total number of training steps: 15

Adapting to environment 0 ...
WARNING: You are demanding a shuffled dataset but did not provide any keys for that.
WARNING: No key provided, using time as seed
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: No key provided for the context initialization. Initializing at 0.
WARNING: No key provided, using time as seed

Compiling function "train_step" for context ...
Shapes of elements in a batch: (1, 1, 20, 2) (20,)
    Epoch:     0     LossContext: 0.02327766
    Epoch:     1     LossContext: 0.01394633
    Epoch:     2     LossContext: 0.00699389
    Epoch:     3     LossContext: 0.00293882
    Epoch:    14     LossContext: 0.00098359

Gradient descent adaptation time: 0 hours 0 mins 7 secs

Adapting to environment 1 ...
WARNING: You are demanding a shuffled dataset but did not provide any keys for that.
WARNING: No key provided, using time as seed
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: No key provided for the context initialization. Initializing at 0.
WARNING: No key provided, using time as seed
    Epoch:     0     LossContext: 0.11778260
    Epoch:     1     LossContext: 0.09682740
    Epoch:     2     LossContext: 0.07583591
    Epoch:     3     LossContext: 0.05561024
    Epoch:    14     LossContext: 0.00075876

Gradient descent adaptation time: 0 hours 0 mins 0 secs

Adapting to environment 2 ...
WARNING: You are demanding a shuffled dataset but did not provide any keys for that.
WARNING: No key provided, using time as seed
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: No key provided for the context initialization. Initializing at 0.
WARNING: No key provided, using time as seed
    Epoch:     0     LossContext: 0.04777515
    Epoch:     1     LossContext: 0.03359828
    Epoch:     2     LossContext: 0.02310447
    Epoch:     3     LossContext: 0.01558673
    Epoch:    14     LossContext: 0.00138627

Gradient descent adaptation time: 0 hours 0 mins 0 secs

Adapting to environment 3 ...
WARNING: You are demanding a shuffled dataset but did not provide any keys for that.
WARNING: No key provided, using time as seed
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: No key provided for the context initialization. Initializing at 0.
WARNING: No key provided, using time as seed
    Epoch:     0     LossContext: 0.02540202
    Epoch:     1     LossContext: 0.01563824
    Epoch:     2     LossContext: 0.00975475
    Epoch:     3     LossContext: 0.00649435
    Epoch:    14     LossContext: 0.00014183

Gradient descent adaptation time: 0 hours 0 mins 0 secs
WARNING: No key provided for the context initialization. Initializing at 0.

Saving adaptation parameters into ./09042024-152116/adapt/ folder with id 170846 ...

==  Begining out-of-distribution testing ... ==
    Number of training environments: 9
    Number of adaptation environments: 4
    Final length of the training trajectories: 20
    Length of the testing trajectories: 20
Test Score (OOD): 0.0011486411


==================== Batch adaptation ====================

WARNING: No key provided for the context initialization. Initializing at 0.


=== Beginning adaptation ... ===
    Number of examples in a batch: 1
    Number of train steps per epoch: 1
    Number of training epochs: 15
    Total number of training steps: 15
WARNING: No key provided, using time as seed

Compiling function "train_step" for context ...
Shapes of elements in a batch: (4, 1, 20, 2) (20,)
    Epoch:     0     LossContext: 0.05367055
    Epoch:     1     LossContext: 0.04017033
    Epoch:     2     LossContext: 0.02901018
    Epoch:     3     LossContext: 0.02031882
    Epoch:    14     LossContext: 0.00116162

Total gradient descent adaptation time: 0 hours 0 mins 6 secs
Environment weights at the end of the adaptation: [0.25 0.25 0.25 0.25]

Saving adaptation parameters into ./09042024-152116/adapt/ folder with id 170846 ...

==  Begining out-of-distribution testing ... ==
    Number of training environments: 9
    Number of adaptation environments: 4
    Final length of the training trajectories: 20
    Length of the testing trajectories: 20
Test Score (OOD): 0.0010941296

