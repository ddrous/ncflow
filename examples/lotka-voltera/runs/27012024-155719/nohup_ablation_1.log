nohup: ignoring input
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: train
 Savepath: ./runs/31012024-090548/
 Seed: 1181

Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: test
 Savepath: ./runs/31012024-090548/
 Seed: 2362

Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: adapt
 Savepath: ./runs/31012024-090548/adapt/
 Seed: 3543


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.19
Available devices: [cuda(id=0)]
Data folder created successfuly: ./runs/31012024-090548/
Completed copied scripts 
WARNING: You did not provide a dataloader id. A new one has been generated: 090554
WARNING: Note that this id used to distuinguish between adaptations to different environments.
Dataset shape: (9, 4, 20, 2)
WARNING: No key provided for the context initialization. Initializing at 0.


=== Beginning training ... ===
    Number of examples in a batch: 4
    Number of train steps per epoch: 1
    Number of training epochs: 200000
    Total number of training steps: 200000

Compiling function "train_step" for neural ode ...
Shapes of elements in a batch: (9, 4, 5, 2) (5,)

Compiling function "train_step" for context ...
Shapes of elements in a batch: (9, 4, 5, 2) (5,)
    Epoch:     0      LossNeuralODE: 1.36825323     LossContext: 1.54769301
    Epoch:     1      LossNeuralODE: 1.56164932     LossContext: 1.47187591
    Epoch:     2      LossNeuralODE: 1.48661602     LossContext: 1.39858520
    Epoch:     3      LossNeuralODE: 1.41404498     LossContext: 1.32830751
    Epoch:  1000      LossNeuralODE: 0.02253761     LossContext: 0.02383966
    Epoch:  2000      LossNeuralODE: 0.00875312     LossContext: 0.00874995
    Epoch:  3000      LossNeuralODE: 0.00733135     LossContext: 0.00745409
    Epoch:  4000      LossNeuralODE: 0.00442512     LossContext: 0.00442115
    Epoch:  5000      LossNeuralODE: 0.00270027     LossContext: 0.00269745
    Epoch:  6000      LossNeuralODE: 0.00674150     LossContext: 0.00677343
    Epoch:  7000      LossNeuralODE: 0.00212192     LossContext: 0.00211951
    Epoch:  8000      LossNeuralODE: 0.00129183     LossContext: 0.00129098
    Epoch:  9000      LossNeuralODE: 0.00083768     LossContext: 0.00083766
    Epoch: 10000      LossNeuralODE: 0.00074185     LossContext: 0.00074170
    Epoch: 11000      LossNeuralODE: 0.00062590     LossContext: 0.00062603
    Epoch: 12000      LossNeuralODE: 0.00052880     LossContext: 0.00052846
    Epoch: 13000      LossNeuralODE: 0.00130279     LossContext: 0.00129956
    Epoch: 14000      LossNeuralODE: 0.00056986     LossContext: 0.00056978
    Epoch: 15000      LossNeuralODE: 0.00046136     LossContext: 0.00046184
    Epoch: 16000      LossNeuralODE: 0.00100824     LossContext: 0.00100817
    Epoch: 17000      LossNeuralODE: 0.00059331     LossContext: 0.00059283
    Epoch: 18000      LossNeuralODE: 0.00040940     LossContext: 0.00040935
    Epoch: 19000      LossNeuralODE: 0.00036450     LossContext: 0.00038569
    Epoch: 20000      LossNeuralODE: 0.00169556     LossContext: 0.00169398
    Epoch: 21000      LossNeuralODE: 0.00180280     LossContext: 0.00179632
    Epoch: 22000      LossNeuralODE: 0.00068800     LossContext: 0.00068806
    Epoch: 23000      LossNeuralODE: 0.00054208     LossContext: 0.00054207
    Epoch: 24000      LossNeuralODE: 0.00083530     LossContext: 0.00083061
    Epoch: 25000      LossNeuralODE: 0.00039839     LossContext: 0.00039851
    Epoch: 26000      LossNeuralODE: 0.00033268     LossContext: 0.00033295
    Epoch: 27000      LossNeuralODE: 0.00070138     LossContext: 0.00070084
    Epoch: 28000      LossNeuralODE: 0.00097266     LossContext: 0.00097326
    Epoch: 29000      LossNeuralODE: 0.00736189     LossContext: 0.00448302
    Epoch: 30000      LossNeuralODE: 0.00209518     LossContext: 0.00209288
    Epoch: 31000      LossNeuralODE: 0.00224359     LossContext: 0.00299586
    Epoch: 32000      LossNeuralODE: 0.00093861     LossContext: 0.00093758
    Epoch: 33000      LossNeuralODE: 0.00841079     LossContext: 0.01111408
    Epoch: 34000      LossNeuralODE: 0.00344024     LossContext: 0.00580116
    Epoch: 35000      LossNeuralODE: 0.03486886     LossContext: 0.03198830
    Epoch: 36000      LossNeuralODE: 0.00103664     LossContext: 0.00103598
    Epoch: 37000      LossNeuralODE: 0.08420989     LossContext: 0.06611384
    Epoch: 38000      LossNeuralODE: 0.00064578     LossContext: 0.00064571
    Epoch: 39000      LossNeuralODE: 0.00441444     LossContext: 0.00438542
    Epoch: 40000      LossNeuralODE: 0.00104644     LossContext: 0.00104591
    Epoch: 41000      LossNeuralODE: 0.00408190     LossContext: 0.00580333
    Epoch: 42000      LossNeuralODE: 0.00393140     LossContext: 0.00392848
    Epoch: 43000      LossNeuralODE: 0.00143108     LossContext: 0.00143043
    Epoch: 44000      LossNeuralODE: 0.00090319     LossContext: 0.00090342
    Epoch: 45000      LossNeuralODE: 0.00372270     LossContext: 0.00591137
    Epoch: 46000      LossNeuralODE: 0.00304011     LossContext: 0.00303802
    Epoch: 47000      LossNeuralODE: 0.00154873     LossContext: 0.00154809
    Epoch: 48000      LossNeuralODE: 0.01565447     LossContext: 0.01506468
    Epoch: 49000      LossNeuralODE: 0.00085705     LossContext: 0.00085780
    Epoch: 50000      LossNeuralODE: 0.00081679     LossContext: 0.00081569
    Epoch: 51000      LossNeuralODE: 0.00063968     LossContext: 0.00063953
    Epoch: 52000      LossNeuralODE: 0.00053927     LossContext: 0.00053969
    Epoch: 53000      LossNeuralODE: 0.00619096     LossContext: 0.00613535
    Epoch: 54000      LossNeuralODE: 0.00068846     LossContext: 0.00068813
    Epoch: 55000      LossNeuralODE: 0.00052026     LossContext: 0.00052014
    Epoch: 56000      LossNeuralODE: 0.00044229     LossContext: 0.00044301
    Epoch: 57000      LossNeuralODE: 0.00038973     LossContext: 0.00038842
    Epoch: 58000      LossNeuralODE: 0.00041545     LossContext: 0.00041554
    Epoch: 59000      LossNeuralODE: 0.00036899     LossContext: 0.00036873
    Epoch: 60000      LossNeuralODE: 0.00033736     LossContext: 0.00033720
    Epoch: 61000      LossNeuralODE: 0.00236096     LossContext: 0.00231902
    Epoch: 62000      LossNeuralODE: 0.00034148     LossContext: 0.00034160
    Epoch: 63000      LossNeuralODE: 0.00031310     LossContext: 0.00031312
    Epoch: 64000      LossNeuralODE: 0.00029580     LossContext: 0.00029593
    Epoch: 65000      LossNeuralODE: 0.00032504     LossContext: 0.00032463
    Epoch: 66000      LossNeuralODE: 0.00028895     LossContext: 0.00028875
    Epoch: 67000      LossNeuralODE: 0.00027863     LossContext: 0.00027846
    Epoch: 68000      LossNeuralODE: 0.00048660     LossContext: 0.00048525
    Epoch: 69000      LossNeuralODE: 0.00029829     LossContext: 0.00029812
    Epoch: 70000      LossNeuralODE: 0.00027874     LossContext: 0.00027867
    Epoch: 71000      LossNeuralODE: 0.00026948     LossContext: 0.00026952
    Epoch: 72000      LossNeuralODE: 0.00031972     LossContext: 0.00031953
    Epoch: 73000      LossNeuralODE: 0.00027675     LossContext: 0.00027679
    Epoch: 74000      LossNeuralODE: 0.00026668     LossContext: 0.00026668
    Epoch: 75000      LossNeuralODE: 0.00026134     LossContext: 0.00026150
    Epoch: 76000      LossNeuralODE: 0.00031095     LossContext: 0.00031062
    Epoch: 77000      LossNeuralODE: 0.00027402     LossContext: 0.00027394
    Epoch: 78000      LossNeuralODE: 0.00026329     LossContext: 0.00026327
    Epoch: 79000      LossNeuralODE: 0.00025825     LossContext: 0.00025817
    Epoch: 80000      LossNeuralODE: 0.00030022     LossContext: 0.00030025
    Epoch: 81000      LossNeuralODE: 0.00026661     LossContext: 0.00026660
    Epoch: 82000      LossNeuralODE: 0.00025867     LossContext: 0.00025862
    Epoch: 83000      LossNeuralODE: 0.00025472     LossContext: 0.00025469
    Epoch: 84000      LossNeuralODE: 0.00032683     LossContext: 0.00032668
    Epoch: 85000      LossNeuralODE: 0.00026836     LossContext: 0.00026823
    Epoch: 86000      LossNeuralODE: 0.00031440     LossContext: 0.00031429
    Epoch: 87000      LossNeuralODE: 0.00026586     LossContext: 0.00026586
    Epoch: 88000      LossNeuralODE: 0.00025738     LossContext: 0.00025738
    Epoch: 89000      LossNeuralODE: 0.00025362     LossContext: 0.00025369
    Epoch: 90000      LossNeuralODE: 0.00038393     LossContext: 0.00038267
    Epoch: 91000      LossNeuralODE: 0.00026072     LossContext: 0.00026084
    Epoch: 92000      LossNeuralODE: 0.00025360     LossContext: 0.00025363
    Epoch: 93000      LossNeuralODE: 0.00025078     LossContext: 0.00025073
    Epoch: 94000      LossNeuralODE: 0.00031452     LossContext: 0.00031404
    Epoch: 95000      LossNeuralODE: 0.00025461     LossContext: 0.00025449
    Epoch: 96000      LossNeuralODE: 0.00025072     LossContext: 0.00025076
    Epoch: 97000      LossNeuralODE: 0.00024861     LossContext: 0.00024852
    Epoch: 98000      LossNeuralODE: 0.00026918     LossContext: 0.00026921
    Epoch: 99000      LossNeuralODE: 0.00025277     LossContext: 0.00025272
    Epoch: 100000      LossNeuralODE: 0.00024918     LossContext: 0.00024916
    Epoch: 101000      LossNeuralODE: 0.00086615     LossContext: 0.00082847
    Epoch: 102000      LossNeuralODE: 0.00025297     LossContext: 0.00025297
    Epoch: 103000      LossNeuralODE: 0.00081794     LossContext: 0.00080904
    Epoch: 104000      LossNeuralODE: 0.00025821     LossContext: 0.00025829
    Epoch: 105000      LossNeuralODE: 0.00025095     LossContext: 0.00025099
    Epoch: 106000      LossNeuralODE: 0.00024859     LossContext: 0.00024855
    Epoch: 107000      LossNeuralODE: 0.00024597     LossContext: 0.00024605
    Epoch: 108000      LossNeuralODE: 0.00026225     LossContext: 0.00026219
    Epoch: 109000      LossNeuralODE: 0.00024902     LossContext: 0.00024899
    Epoch: 110000      LossNeuralODE: 0.00024649     LossContext: 0.00024650
    Epoch: 111000      LossNeuralODE: 0.00024448     LossContext: 0.00024447
    Epoch: 112000      LossNeuralODE: 0.00025029     LossContext: 0.00025032
    Epoch: 113000      LossNeuralODE: 0.00024683     LossContext: 0.00024708
    Epoch: 114000      LossNeuralODE: 0.00025023     LossContext: 0.00025024
    Epoch: 115000      LossNeuralODE: 0.00024669     LossContext: 0.00024671
    Epoch: 116000      LossNeuralODE: 0.00024509     LossContext: 0.00024512
    Epoch: 117000      LossNeuralODE: 0.00228903     LossContext: 0.00194794
    Epoch: 118000      LossNeuralODE: 0.00024826     LossContext: 0.00024828
    Epoch: 119000      LossNeuralODE: 0.01767198     LossContext: 0.00656987
    Epoch: 120000      LossNeuralODE: 0.00024874     LossContext: 0.00024871
    Epoch: 121000      LossNeuralODE: 0.00024582     LossContext: 0.00024585
    Epoch: 122000      LossNeuralODE: 0.00024438     LossContext: 0.00024440
    Epoch: 123000      LossNeuralODE: 0.00024264     LossContext: 0.00024278
    Epoch: 124000      LossNeuralODE: 0.00024916     LossContext: 0.00024908
    Epoch: 125000      LossNeuralODE: 0.00024337     LossContext: 0.00024339
    Epoch: 126000      LossNeuralODE: 0.00024217     LossContext: 0.00024210
    Epoch: 127000      LossNeuralODE: 0.00024109     LossContext: 0.00024108
    Epoch: 128000      LossNeuralODE: 0.00025120     LossContext: 0.00025114
    Epoch: 129000      LossNeuralODE: 0.00024556     LossContext: 0.00024556
    Epoch: 130000      LossNeuralODE: 0.00025073     LossContext: 0.00025066
    Epoch: 131000      LossNeuralODE: 0.00024479     LossContext: 0.00024477
    Epoch: 132000      LossNeuralODE: 0.00024294     LossContext: 0.00024291
    Epoch: 133000      LossNeuralODE: 0.00024152     LossContext: 0.00024153
    Epoch: 134000      LossNeuralODE: 0.00025955     LossContext: 0.00025934
    Epoch: 135000      LossNeuralODE: 0.00024205     LossContext: 0.00024204
    Epoch: 136000      LossNeuralODE: 0.00024087     LossContext: 0.00024082
    Epoch: 137000      LossNeuralODE: 0.00023989     LossContext: 0.00023992
    Epoch: 138000      LossNeuralODE: 0.00024571     LossContext: 0.00024573
    Epoch: 139000      LossNeuralODE: 0.00024203     LossContext: 0.00024209
    Epoch: 140000      LossNeuralODE: 0.00024659     LossContext: 0.00024655
    Epoch: 141000      LossNeuralODE: 0.00024146     LossContext: 0.00024150
    Epoch: 142000      LossNeuralODE: 0.00024069     LossContext: 0.00024070
    Epoch: 143000      LossNeuralODE: 0.00023967     LossContext: 0.00023977
    Epoch: 144000      LossNeuralODE: 0.00024888     LossContext: 0.00024877
    Epoch: 145000      LossNeuralODE: 0.00024029     LossContext: 0.00024027
    Epoch: 146000      LossNeuralODE: 0.00023930     LossContext: 0.00023931
    Epoch: 147000      LossNeuralODE: 0.00027916     LossContext: 0.00027744
    Epoch: 148000      LossNeuralODE: 0.00024054     LossContext: 0.00024050
    Epoch: 149000      LossNeuralODE: 0.00122406     LossContext: 0.00110986
    Epoch: 150000      LossNeuralODE: 0.00024077     LossContext: 0.00024074
    Epoch: 151000      LossNeuralODE: 0.00024033     LossContext: 0.00024034
    Epoch: 152000      LossNeuralODE: 0.00024000     LossContext: 0.00023999
    Epoch: 153000      LossNeuralODE: 0.00023972     LossContext: 0.00023976
    Epoch: 154000      LossNeuralODE: 0.00023947     LossContext: 0.00023945
    Epoch: 155000      LossNeuralODE: 0.00023888     LossContext: 0.00023886
    Epoch: 156000      LossNeuralODE: 0.00023857     LossContext: 0.00023857
    Epoch: 157000      LossNeuralODE: 0.00023811     LossContext: 0.00023809
    Epoch: 158000      LossNeuralODE: 0.00023712     LossContext: 0.00023707
    Epoch: 159000      LossNeuralODE: 0.00023669     LossContext: 0.00023670
    Epoch: 160000      LossNeuralODE: 0.00023656     LossContext: 0.00023654
    Epoch: 161000      LossNeuralODE: 0.00023634     LossContext: 0.00023629
    Epoch: 162000      LossNeuralODE: 0.00023591     LossContext: 0.00023579
    Epoch: 163000      LossNeuralODE: 0.00023672     LossContext: 0.00023650
    Epoch: 164000      LossNeuralODE: 0.00023471     LossContext: 0.00023440
    Epoch: 165000      LossNeuralODE: 0.00023498     LossContext: 0.00023501
    Epoch: 166000      LossNeuralODE: 0.00023489     LossContext: 0.00023490
    Epoch: 167000      LossNeuralODE: 0.00023476     LossContext: 0.00023469
    Epoch: 168000      LossNeuralODE: 0.00023469     LossContext: 0.00023456
    Epoch: 169000      LossNeuralODE: 0.00023488     LossContext: 0.00023492
    Epoch: 170000      LossNeuralODE: 0.00023456     LossContext: 0.00023453
    Epoch: 171000      LossNeuralODE: 0.00023444     LossContext: 0.00023446
    Epoch: 172000      LossNeuralODE: 0.00023393     LossContext: 0.00023384
    Epoch: 173000      LossNeuralODE: 0.00023439     LossContext: 0.00023444
    Epoch: 174000      LossNeuralODE: 0.00022979     LossContext: 0.00021804
    Epoch: 175000      LossNeuralODE: 0.00023376     LossContext: 0.00023376
    Epoch: 176000      LossNeuralODE: 0.00023373     LossContext: 0.00023372
    Epoch: 177000      LossNeuralODE: 0.00023322     LossContext: 0.00023319
    Epoch: 178000      LossNeuralODE: 0.00023316     LossContext: 0.00023323
    Epoch: 179000      LossNeuralODE: 0.00023308     LossContext: 0.00023321
    Epoch: 180000      LossNeuralODE: 0.00023314     LossContext: 0.00023318
    Epoch: 181000      LossNeuralODE: 0.00023274     LossContext: 0.00023270
    Epoch: 182000      LossNeuralODE: 0.00023257     LossContext: 0.00023229
    Epoch: 183000      LossNeuralODE: 0.00023795     LossContext: 0.00023850
    Epoch: 184000      LossNeuralODE: 0.00023260     LossContext: 0.00023256
    Epoch: 185000      LossNeuralODE: 0.00023267     LossContext: 0.00023266
    Epoch: 186000      LossNeuralODE: 0.00023230     LossContext: 0.00023231
    Epoch: 187000      LossNeuralODE: 0.00023227     LossContext: 0.00023222
    Epoch: 188000      LossNeuralODE: 0.00023240     LossContext: 0.00023239
    Epoch: 189000      LossNeuralODE: 0.00023225     LossContext: 0.00023224
    Epoch: 190000      LossNeuralODE: 0.00030097     LossContext: 0.00029453
    Epoch: 191000      LossNeuralODE: 0.00023199     LossContext: 0.00023202
    Epoch: 192000      LossNeuralODE: 0.00023201     LossContext: 0.00023199
    Epoch: 193000      LossNeuralODE: 0.00023160     LossContext: 0.00023162
    Epoch: 194000      LossNeuralODE: 0.00023151     LossContext: 0.00023150
    Epoch: 195000      LossNeuralODE: 0.00023167     LossContext: 0.00023171
    Epoch: 196000      LossNeuralODE: 0.00023139     LossContext: 0.00023139
    Epoch: 197000      LossNeuralODE: 0.00023137     LossContext: 0.00023135
    Epoch: 198000      LossNeuralODE: 0.00023136     LossContext: 0.00023137
    Epoch: 199000      LossNeuralODE: 0.00023138     LossContext: 0.00023130
    Epoch: 199999      LossNeuralODE: 0.00023092     LossContext: 0.00023095

Total gradient descent training time: 0 hours 35 mins 11 secs
Environment weights at the end of the training: [0.120286   0.09278463 0.14747588 0.09779934 0.0980162  0.08169927
 0.14176111 0.1144296  0.10574795]

Saving model and results into ./runs/31012024-090548/ folder ...



=== Beginning training ... ===
    Number of examples in a batch: 4
    Number of train steps per epoch: 1
    Number of training epochs: 400000
    Total number of training steps: 400000

Compiling function "train_step" for neural ode ...
Shapes of elements in a batch: (9, 4, 20, 2) (20,)

Compiling function "train_step" for context ...
Shapes of elements in a batch: (9, 4, 20, 2) (20,)
    Epoch:     0      LossNeuralODE: 0.06799278     LossContext: 0.08304894
    Epoch:     1      LossNeuralODE: 0.08294143     LossContext: 0.04996018
    Epoch:     2      LossNeuralODE: 0.05225128     LossContext: 0.04049051
    Epoch:     3      LossNeuralODE: 0.04078341     LossContext: 0.03369181
    Epoch:  2000      LossNeuralODE: 0.00095228     LossContext: 0.00095229
    Epoch:  4000      LossNeuralODE: 0.00058856     LossContext: 0.00058832
    Epoch:  6000      LossNeuralODE: 0.00046851     LossContext: 0.00046846
    Epoch:  8000      LossNeuralODE: 0.00041602     LossContext: 0.00041593
    Epoch: 10000      LossNeuralODE: 0.00038220     LossContext: 0.00038223
    Epoch: 12000      LossNeuralODE: 0.00035580     LossContext: 0.00035579
    Epoch: 14000      LossNeuralODE: 0.00033758     LossContext: 0.00033760
    Epoch: 16000      LossNeuralODE: 0.00032756     LossContext: 0.00032765
    Epoch: 18000      LossNeuralODE: 0.00031906     LossContext: 0.00031974
    Epoch: 20000      LossNeuralODE: 0.00030958     LossContext: 0.00030958
    Epoch: 22000      LossNeuralODE: 0.00030287     LossContext: 0.00030287
    Epoch: 24000      LossNeuralODE: 0.00029979     LossContext: 0.00029851
    Epoch: 26000      LossNeuralODE: 0.00029285     LossContext: 0.00029289
    Epoch: 28000      LossNeuralODE: 0.00030892     LossContext: 0.00029610
    Epoch: 30000      LossNeuralODE: 0.00028611     LossContext: 0.00028612
    Epoch: 32000      LossNeuralODE: 0.00028324     LossContext: 0.00028320
    Epoch: 34000      LossNeuralODE: 0.00028044     LossContext: 0.00028104
    Epoch: 36000      LossNeuralODE: 0.00027746     LossContext: 0.00027771
    Epoch: 38000      LossNeuralODE: 0.00028363     LossContext: 0.00027874
    Epoch: 40000      LossNeuralODE: 0.00027532     LossContext: 0.00027429
    Epoch: 42000      LossNeuralODE: 0.00027592     LossContext: 0.00027591
    Epoch: 44000      LossNeuralODE: 0.00026960     LossContext: 0.00026962
    Epoch: 46000      LossNeuralODE: 0.00026782     LossContext: 0.00026792
    Epoch: 48000      LossNeuralODE: 0.00028257     LossContext: 0.00027151
    Epoch: 50000      LossNeuralODE: 0.00026490     LossContext: 0.00026493
    Epoch: 52000      LossNeuralODE: 0.00026554     LossContext: 0.00026540
    Epoch: 54000      LossNeuralODE: 0.00026273     LossContext: 0.00026278
    Epoch: 56000      LossNeuralODE: 0.00026203     LossContext: 0.00026206
    Epoch: 58000      LossNeuralODE: 0.00026104     LossContext: 0.00026090
    Epoch: 60000      LossNeuralODE: 0.00025993     LossContext: 0.00025999
    Epoch: 62000      LossNeuralODE: 0.00025939     LossContext: 0.00025940
    Epoch: 64000      LossNeuralODE: 0.00025798     LossContext: 0.00025787
    Epoch: 66000      LossNeuralODE: 0.00025743     LossContext: 0.00025745
    Epoch: 68000      LossNeuralODE: 0.00025716     LossContext: 0.00025710
    Epoch: 70000      LossNeuralODE: 0.00025640     LossContext: 0.00025659
    Epoch: 72000      LossNeuralODE: 0.00025647     LossContext: 0.00025539
    Epoch: 74000      LossNeuralODE: 0.00025500     LossContext: 0.00026050
    Epoch: 76000      LossNeuralODE: 0.00026172     LossContext: 0.00025654
    Epoch: 78000      LossNeuralODE: 0.00025367     LossContext: 0.00025356
    Epoch: 80000      LossNeuralODE: 0.00025267     LossContext: 0.00025284
    Epoch: 82000      LossNeuralODE: 0.00025221     LossContext: 0.00025222
    Epoch: 84000      LossNeuralODE: 0.00025838     LossContext: 0.00025572
    Epoch: 86000      LossNeuralODE: 0.00025127     LossContext: 0.00025136
    Epoch: 88000      LossNeuralODE: 0.00025137     LossContext: 0.00025164
    Epoch: 90000      LossNeuralODE: 0.00026079     LossContext: 0.00026076
    Epoch: 92000      LossNeuralODE: 0.00025016     LossContext: 0.00025024
    Epoch: 94000      LossNeuralODE: 0.00025208     LossContext: 0.00025200
    Epoch: 96000      LossNeuralODE: 0.00024929     LossContext: 0.00024922
    Epoch: 98000      LossNeuralODE: 0.00024898     LossContext: 0.00024895
    Epoch: 100000      LossNeuralODE: 0.00024844     LossContext: 0.00024845
    Epoch: 102000      LossNeuralODE: 0.00024847     LossContext: 0.00024849
    Epoch: 104000      LossNeuralODE: 0.00024811     LossContext: 0.00024819
    Epoch: 106000      LossNeuralODE: 0.00024764     LossContext: 0.00024804
    Epoch: 108000      LossNeuralODE: 0.00024789     LossContext: 0.00024862
    Epoch: 110000      LossNeuralODE: 0.00024676     LossContext: 0.00024664
    Epoch: 112000      LossNeuralODE: 0.00024649     LossContext: 0.00024655
    Epoch: 114000      LossNeuralODE: 0.00024600     LossContext: 0.00024607
    Epoch: 116000      LossNeuralODE: 0.00024545     LossContext: 0.00024547
    Epoch: 118000      LossNeuralODE: 0.00024546     LossContext: 0.00024534
    Epoch: 120000      LossNeuralODE: 0.00024539     LossContext: 0.00024548
    Epoch: 122000      LossNeuralODE: 0.00024554     LossContext: 0.00024530
    Epoch: 124000      LossNeuralODE: 0.00024450     LossContext: 0.00024452
    Epoch: 126000      LossNeuralODE: 0.00024667     LossContext: 0.00024598
    Epoch: 128000      LossNeuralODE: 0.00024669     LossContext: 0.00024557
    Epoch: 130000      LossNeuralODE: 0.00024366     LossContext: 0.00024381
    Epoch: 132000      LossNeuralODE: 0.00024363     LossContext: 0.00024359
    Epoch: 134000      LossNeuralODE: 0.00024326     LossContext: 0.00024317
    Epoch: 136000      LossNeuralODE: 0.00024290     LossContext: 0.00024288
    Epoch: 138000      LossNeuralODE: 0.00024282     LossContext: 0.00024277
    Epoch: 140000      LossNeuralODE: 0.00024312     LossContext: 0.00024302
    Epoch: 142000      LossNeuralODE: 0.00024347     LossContext: 0.00024335
    Epoch: 144000      LossNeuralODE: 0.00024381     LossContext: 0.00024403
    Epoch: 146000      LossNeuralODE: 0.00024202     LossContext: 0.00024208
    Epoch: 148000      LossNeuralODE: 0.00024169     LossContext: 0.00024172
    Epoch: 150000      LossNeuralODE: 0.00024230     LossContext: 0.00024209
    Epoch: 152000      LossNeuralODE: 0.00024175     LossContext: 0.00024172
    Epoch: 154000      LossNeuralODE: 0.00024122     LossContext: 0.00024130
    Epoch: 156000      LossNeuralODE: 0.00024149     LossContext: 0.00024147
    Epoch: 158000      LossNeuralODE: 0.00024094     LossContext: 0.00024142
    Epoch: 160000      LossNeuralODE: 0.00024091     LossContext: 0.00024089
    Epoch: 162000      LossNeuralODE: 0.00024068     LossContext: 0.00024070
    Epoch: 164000      LossNeuralODE: 0.00024043     LossContext: 0.00024058
    Epoch: 166000      LossNeuralODE: 0.00024053     LossContext: 0.00024060
    Epoch: 168000      LossNeuralODE: 0.00024012     LossContext: 0.00024006
    Epoch: 170000      LossNeuralODE: 0.00024065     LossContext: 0.00024077
    Epoch: 172000      LossNeuralODE: 0.00023971     LossContext: 0.00023990
    Epoch: 174000      LossNeuralODE: 0.00024019     LossContext: 0.00024004
    Epoch: 176000      LossNeuralODE: 0.00023958     LossContext: 0.00023958
    Epoch: 178000      LossNeuralODE: 0.00024248     LossContext: 0.00024281
    Epoch: 180000      LossNeuralODE: 0.00023951     LossContext: 0.00023959
    Epoch: 182000      LossNeuralODE: 0.00024155     LossContext: 0.00024093
    Epoch: 184000      LossNeuralODE: 0.00024103     LossContext: 0.00024077
    Epoch: 186000      LossNeuralODE: 0.00023896     LossContext: 0.00023895
    Epoch: 188000      LossNeuralODE: 0.00023945     LossContext: 0.00023927
    Epoch: 190000      LossNeuralODE: 0.00023903     LossContext: 0.00023893
    Epoch: 192000      LossNeuralODE: 0.00023849     LossContext: 0.00023875
    Epoch: 194000      LossNeuralODE: 0.00023877     LossContext: 0.00023857
    Epoch: 196000      LossNeuralODE: 0.00023862     LossContext: 0.00023861
    Epoch: 198000      LossNeuralODE: 0.00023908     LossContext: 0.00023884
    Epoch: 200000      LossNeuralODE: 0.00023803     LossContext: 0.00023803
    Epoch: 202000      LossNeuralODE: 0.00023835     LossContext: 0.00023806
    Epoch: 204000      LossNeuralODE: 0.00023788     LossContext: 0.00023789
    Epoch: 206000      LossNeuralODE: 0.00023767     LossContext: 0.00023795
    Epoch: 208000      LossNeuralODE: 0.00023774     LossContext: 0.00023770
    Epoch: 210000      LossNeuralODE: 0.00023977     LossContext: 0.00024056
    Epoch: 212000      LossNeuralODE: 0.00023760     LossContext: 0.00023752
    Epoch: 214000      LossNeuralODE: 0.00023936     LossContext: 0.00023899
    Epoch: 216000      LossNeuralODE: 0.00023787     LossContext: 0.00023817
    Epoch: 218000      LossNeuralODE: 0.00023725     LossContext: 0.00023734
    Epoch: 220000      LossNeuralODE: 0.00023753     LossContext: 0.00023756
    Epoch: 222000      LossNeuralODE: 0.00023756     LossContext: 0.00023761
    Epoch: 224000      LossNeuralODE: 0.00023691     LossContext: 0.00023693
    Epoch: 226000      LossNeuralODE: 0.00023720     LossContext: 0.00023728
    Epoch: 228000      LossNeuralODE: 0.00023707     LossContext: 0.00023716
    Epoch: 230000      LossNeuralODE: 0.00023688     LossContext: 0.00023680
    Epoch: 232000      LossNeuralODE: 0.00023640     LossContext: 0.00023704
    Epoch: 234000      LossNeuralODE: 0.00023661     LossContext: 0.00023764
    Epoch: 236000      LossNeuralODE: 0.00023694     LossContext: 0.00023703
    Epoch: 238000      LossNeuralODE: 0.00023657     LossContext: 0.00023657
    Epoch: 240000      LossNeuralODE: 0.00023664     LossContext: 0.00023700
    Epoch: 242000      LossNeuralODE: 0.00023827     LossContext: 0.00023811
    Epoch: 244000      LossNeuralODE: 0.00023657     LossContext: 0.00023636
    Epoch: 246000      LossNeuralODE: 0.00023610     LossContext: 0.00023610
    Epoch: 248000      LossNeuralODE: 0.00023644     LossContext: 0.00023648
    Epoch: 250000      LossNeuralODE: 0.00023584     LossContext: 0.00023588
    Epoch: 252000      LossNeuralODE: 0.00023606     LossContext: 0.00023605
    Epoch: 254000      LossNeuralODE: 0.00023615     LossContext: 0.00023608
    Epoch: 256000      LossNeuralODE: 0.00023724     LossContext: 0.00023685
    Epoch: 258000      LossNeuralODE: 0.00023602     LossContext: 0.00023611
    Epoch: 260000      LossNeuralODE: 0.00023608     LossContext: 0.00023599
    Epoch: 262000      LossNeuralODE: 0.00023582     LossContext: 0.00023582
    Epoch: 264000      LossNeuralODE: 0.00023570     LossContext: 0.00023579
    Epoch: 266000      LossNeuralODE: 0.00023594     LossContext: 0.00023594
    Epoch: 268000      LossNeuralODE: 0.00023559     LossContext: 0.00023563
    Epoch: 270000      LossNeuralODE: 0.00023553     LossContext: 0.00023557
    Epoch: 272000      LossNeuralODE: 0.00023540     LossContext: 0.00023544
    Epoch: 274000      LossNeuralODE: 0.00023565     LossContext: 0.00023578
    Epoch: 276000      LossNeuralODE: 0.00023540     LossContext: 0.00023540
    Epoch: 278000      LossNeuralODE: 0.00023545     LossContext: 0.00023542
    Epoch: 280000      LossNeuralODE: 0.00023551     LossContext: 0.00023555
    Epoch: 282000      LossNeuralODE: 0.00023529     LossContext: 0.00023540
    Epoch: 284000      LossNeuralODE: 0.00023527     LossContext: 0.00023524
    Epoch: 286000      LossNeuralODE: 0.00023510     LossContext: 0.00023505
    Epoch: 288000      LossNeuralODE: 0.00023525     LossContext: 0.00023516
    Epoch: 290000      LossNeuralODE: 0.00023536     LossContext: 0.00023537
    Epoch: 292000      LossNeuralODE: 0.00023550     LossContext: 0.00023543
    Epoch: 294000      LossNeuralODE: 0.00023488     LossContext: 0.00023483
    Epoch: 296000      LossNeuralODE: 0.00023488     LossContext: 0.00023486
    Epoch: 298000      LossNeuralODE: 0.00023488     LossContext: 0.00023500
    Epoch: 300000      LossNeuralODE: 0.00023488     LossContext: 0.00023492
    Epoch: 302000      LossNeuralODE: 0.00023467     LossContext: 0.00023467
    Epoch: 304000      LossNeuralODE: 0.00023481     LossContext: 0.00023481
    Epoch: 306000      LossNeuralODE: 0.00023488     LossContext: 0.00023487
    Epoch: 308000      LossNeuralODE: 0.00023470     LossContext: 0.00023462
    Epoch: 310000      LossNeuralODE: 0.00023482     LossContext: 0.00023473
    Epoch: 312000      LossNeuralODE: 0.00023443     LossContext: 0.00023428
    Epoch: 314000      LossNeuralODE: 0.00023465     LossContext: 0.00023463
    Epoch: 316000      LossNeuralODE: 0.00023443     LossContext: 0.00023447
    Epoch: 318000      LossNeuralODE: 0.00023441     LossContext: 0.00023441
    Epoch: 320000      LossNeuralODE: 0.00023449     LossContext: 0.00023452
    Epoch: 322000      LossNeuralODE: 0.00023439     LossContext: 0.00023443
    Epoch: 324000      LossNeuralODE: 0.00023445     LossContext: 0.00023449
    Epoch: 326000      LossNeuralODE: 0.00023446     LossContext: 0.00023444
    Epoch: 328000      LossNeuralODE: 0.00023433     LossContext: 0.00023438
    Epoch: 330000      LossNeuralODE: 0.00023420     LossContext: 0.00023424
    Epoch: 332000      LossNeuralODE: 0.00023414     LossContext: 0.00023414
    Epoch: 334000      LossNeuralODE: 0.00023419     LossContext: 0.00023411
    Epoch: 336000      LossNeuralODE: 0.00023413     LossContext: 0.00023416
    Epoch: 338000      LossNeuralODE: 0.00023416     LossContext: 0.00023414
    Epoch: 340000      LossNeuralODE: 0.00023420     LossContext: 0.00023406
    Epoch: 342000      LossNeuralODE: 0.00023408     LossContext: 0.00023407
    Epoch: 344000      LossNeuralODE: 0.00023398     LossContext: 0.00023390
    Epoch: 346000      LossNeuralODE: 0.00023432     LossContext: 0.00023423
    Epoch: 348000      LossNeuralODE: 0.00023380     LossContext: 0.00023391
    Epoch: 350000      LossNeuralODE: 0.00023392     LossContext: 0.00023389
    Epoch: 352000      LossNeuralODE: 0.00023386     LossContext: 0.00023391
    Epoch: 354000      LossNeuralODE: 0.00023391     LossContext: 0.00023389
    Epoch: 356000      LossNeuralODE: 0.00023385     LossContext: 0.00023392
    Epoch: 358000      LossNeuralODE: 0.00023396     LossContext: 0.00023398
    Epoch: 360000      LossNeuralODE: 0.00023359     LossContext: 0.00023359
    Epoch: 362000      LossNeuralODE: 0.00023391     LossContext: 0.00023388
    Epoch: 364000      LossNeuralODE: 0.00023373     LossContext: 0.00023369
    Epoch: 366000      LossNeuralODE: 0.00023390     LossContext: 0.00023393
    Epoch: 368000      LossNeuralODE: 0.00023379     LossContext: 0.00023380
    Epoch: 370000      LossNeuralODE: 0.00023336     LossContext: 0.00023330
    Epoch: 372000      LossNeuralODE: 0.00023328     LossContext: 0.00023326
    Epoch: 374000      LossNeuralODE: 0.00023359     LossContext: 0.00023360
    Epoch: 376000      LossNeuralODE: 0.00023345     LossContext: 0.00023350
    Epoch: 378000      LossNeuralODE: 0.00023335     LossContext: 0.00023333
    Epoch: 380000      LossNeuralODE: 0.00023326     LossContext: 0.00023326
    Epoch: 382000      LossNeuralODE: 0.00023355     LossContext: 0.00023357
    Epoch: 384000      LossNeuralODE: 0.00023338     LossContext: 0.00023332
    Epoch: 386000      LossNeuralODE: 0.00023346     LossContext: 0.00023353
    Epoch: 388000      LossNeuralODE: 0.00023317     LossContext: 0.00023325
    Epoch: 390000      LossNeuralODE: 0.00023314     LossContext: 0.00023310
    Epoch: 392000      LossNeuralODE: 0.00023311     LossContext: 0.00023308
    Epoch: 394000      LossNeuralODE: 0.00023313     LossContext: 0.00023301
    Epoch: 396000      LossNeuralODE: 0.00023295     LossContext: 0.00023295
    Epoch: 398000      LossNeuralODE: 0.00023313     LossContext: 0.00023303
    Epoch: 399999      LossNeuralODE: 0.00023287     LossContext: 0.00023287

Total gradient descent training time: 4 hours 6 mins 22 secs
Environment weights at the end of the training: [0.08855081 0.1264842  0.133921   0.09717821 0.12409448 0.07604716
 0.11723191 0.13371165 0.10278063]

Saving model and results into ./runs/31012024-090548/ folder ...

WARNING: You did not provide a dataloader id. A new one has been generated: 135040
WARNING: Note that this id used to distuinguish between adaptations to different environments.
Dataset shape: (9, 32, 20, 2)
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: No key provided, using time as seed
==  Begining in-domain testing ... ==
    Number of training environments: 9
    Final length of the training trajectories: 20
    Length of the testing trajectories: 20
Test Score (In-Domain): 0.0001167728

==  Begining in-domain visualisation ... ==
    Environment id: 4
    Trajectory id: 15
    Final length of the training trajectories: 20
    Length of the testing trajectories: 20
Testing finished. Figure saved in: ./runs/31012024-090548/results_in_domain.png
Dataset shape: (4, 1, 20, 2)
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: No key provided for the context initialization. Initializing at 0.


=== Beginning adaptation ... ===
    Number of examples in a batch: 1
    Number of train steps per epoch: 1
    Number of training epochs: 200000
    Total number of training steps: 200000

Compiling function "train_step" for context ...
Shapes of elements in a batch: (4, 1, 20, 2) (20,)
    Epoch:     0     LossContext: 0.79901147
    Epoch:     1     LossContext: 0.77876973
    Epoch:     2     LossContext: 0.75643677
    Epoch:     3     LossContext: 0.73358268
    Epoch:  1000     LossContext: 0.00116855
    Epoch:  2000     LossContext: 0.00052044
    Epoch:  3000     LossContext: 0.00039981
    Epoch:  4000     LossContext: 0.00031944
    Epoch:  5000     LossContext: 0.00025489
    Epoch:  6000     LossContext: 0.00020258
    Epoch:  7000     LossContext: 0.00021731
    Epoch:  8000     LossContext: 0.00016805
    Epoch:  9000     LossContext: 0.00015515
    Epoch: 10000     LossContext: 0.00014098
    Epoch: 11000     LossContext: 0.00012544
    Epoch: 12000     LossContext: 0.00011018
    Epoch: 13000     LossContext: 0.00011432
    Epoch: 14000     LossContext: 0.00010561
    Epoch: 15000     LossContext: 0.00010142
    Epoch: 16000     LossContext: 0.00009716
    Epoch: 17000     LossContext: 0.00009208
    Epoch: 18000     LossContext: 0.00333415
    Epoch: 19000     LossContext: 0.00008913
    Epoch: 20000     LossContext: 0.00008594
    Epoch: 21000     LossContext: 0.00008387
    Epoch: 22000     LossContext: 0.00008169
    Epoch: 23000     LossContext: 0.00007904
    Epoch: 24000     LossContext: 0.00008523
    Epoch: 25000     LossContext: 0.00007842
    Epoch: 26000     LossContext: 0.00007698
    Epoch: 27000     LossContext: 0.00007579
    Epoch: 28000     LossContext: 0.00007438
    Epoch: 29000     LossContext: 0.00015606
    Epoch: 30000     LossContext: 0.00007666
    Epoch: 31000     LossContext: 0.00007383
    Epoch: 32000     LossContext: 0.00007256
    Epoch: 33000     LossContext: 0.00007163
    Epoch: 34000     LossContext: 0.00017174
    Epoch: 35000     LossContext: 0.00007373
    Epoch: 36000     LossContext: 0.00007157
    Epoch: 37000     LossContext: 0.00007051
    Epoch: 38000     LossContext: 0.00006975
    Epoch: 39000     LossContext: 0.00006891
    Epoch: 40000     LossContext: 0.00007430
    Epoch: 41000     LossContext: 0.00007026
    Epoch: 42000     LossContext: 0.00006904
    Epoch: 43000     LossContext: 0.00006830
    Epoch: 44000     LossContext: 0.00006766
    Epoch: 45000     LossContext: 0.00010233
    Epoch: 46000     LossContext: 0.00006901
    Epoch: 47000     LossContext: 0.00006739
    Epoch: 48000     LossContext: 0.00006667
    Epoch: 49000     LossContext: 0.00006616
    Epoch: 50000     LossContext: 0.00006567
    Epoch: 51000     LossContext: 0.00006539
    Epoch: 52000     LossContext: 0.00006523
    Epoch: 53000     LossContext: 0.00006496
    Epoch: 54000     LossContext: 0.00006454
    Epoch: 55000     LossContext: 0.00006393
    Epoch: 56000     LossContext: 0.00006327
    Epoch: 57000     LossContext: 0.00006263
    Epoch: 58000     LossContext: 0.00006203
    Epoch: 59000     LossContext: 0.00006145
    Epoch: 60000     LossContext: 0.00006092
    Epoch: 61000     LossContext: 0.00006041
    Epoch: 62000     LossContext: 0.00005994
    Epoch: 63000     LossContext: 0.00005950
    Epoch: 64000     LossContext: 0.00005909
    Epoch: 65000     LossContext: 0.00005870
    Epoch: 66000     LossContext: 0.00005833
    Epoch: 67000     LossContext: 0.00005797
    Epoch: 68000     LossContext: 0.00005763
    Epoch: 69000     LossContext: 0.00005731
    Epoch: 70000     LossContext: 0.00005700
    Epoch: 71000     LossContext: 0.00005670
    Epoch: 72000     LossContext: 0.00005642
    Epoch: 73000     LossContext: 0.00005615
    Epoch: 74000     LossContext: 0.00005588
    Epoch: 75000     LossContext: 0.00005562
    Epoch: 76000     LossContext: 0.00005537
    Epoch: 77000     LossContext: 0.00005512
    Epoch: 78000     LossContext: 0.00005489
    Epoch: 79000     LossContext: 0.00005466
    Epoch: 80000     LossContext: 0.00005444
    Epoch: 81000     LossContext: 0.00005423
    Epoch: 82000     LossContext: 0.00005402
    Epoch: 83000     LossContext: 0.00005381
    Epoch: 84000     LossContext: 0.00005361
    Epoch: 85000     LossContext: 0.00005341
    Epoch: 86000     LossContext: 0.00005322
    Epoch: 87000     LossContext: 0.00005302
    Epoch: 88000     LossContext: 0.00005285
    Epoch: 89000     LossContext: 0.00005266
    Epoch: 90000     LossContext: 0.00005249
    Epoch: 91000     LossContext: 0.00005232
    Epoch: 92000     LossContext: 0.00005215
    Epoch: 93000     LossContext: 0.00005198
    Epoch: 94000     LossContext: 0.00005183
    Epoch: 95000     LossContext: 0.00005168
    Epoch: 96000     LossContext: 0.00005153
    Epoch: 97000     LossContext: 0.00005138
    Epoch: 98000     LossContext: 0.00005125
    Epoch: 99000     LossContext: 0.00005111
    Epoch: 100000     LossContext: 0.00005098
    Epoch: 101000     LossContext: 0.00005096
    Epoch: 102000     LossContext: 0.00005093
    Epoch: 103000     LossContext: 0.00005090
    Epoch: 104000     LossContext: 0.00005085
    Epoch: 105000     LossContext: 0.00005079
    Epoch: 106000     LossContext: 0.00005072
    Epoch: 107000     LossContext: 0.00005064
    Epoch: 108000     LossContext: 0.00005057
    Epoch: 109000     LossContext: 0.00005050
    Epoch: 110000     LossContext: 0.00005043
    Epoch: 111000     LossContext: 0.00005036
    Epoch: 112000     LossContext: 0.00005029
    Epoch: 113000     LossContext: 0.00005022
    Epoch: 114000     LossContext: 0.00005015
    Epoch: 115000     LossContext: 0.00005008
    Epoch: 116000     LossContext: 0.00005001
    Epoch: 117000     LossContext: 0.00004994
    Epoch: 118000     LossContext: 0.00004987
    Epoch: 119000     LossContext: 0.00004980
    Epoch: 120000     LossContext: 0.00004974
    Epoch: 121000     LossContext: 0.00004967
    Epoch: 122000     LossContext: 0.00004961
    Epoch: 123000     LossContext: 0.00004954
    Epoch: 124000     LossContext: 0.00004948
    Epoch: 125000     LossContext: 0.00004942
    Epoch: 126000     LossContext: 0.00004936
    Epoch: 127000     LossContext: 0.00004930
    Epoch: 128000     LossContext: 0.00004925
    Epoch: 129000     LossContext: 0.00004919
    Epoch: 130000     LossContext: 0.00004913
    Epoch: 131000     LossContext: 0.00004908
    Epoch: 132000     LossContext: 0.00004902
    Epoch: 133000     LossContext: 0.00004897
    Epoch: 134000     LossContext: 0.00004891
    Epoch: 135000     LossContext: 0.00004886
    Epoch: 136000     LossContext: 0.00004881
    Epoch: 137000     LossContext: 0.00004875
    Epoch: 138000     LossContext: 0.00004870
    Epoch: 139000     LossContext: 0.00004864
    Epoch: 140000     LossContext: 0.00004859
    Epoch: 141000     LossContext: 0.00004854
    Epoch: 142000     LossContext: 0.00004848
    Epoch: 143000     LossContext: 0.00004843
    Epoch: 144000     LossContext: 0.00004838
    Epoch: 145000     LossContext: 0.00004833
    Epoch: 146000     LossContext: 0.00004828
    Epoch: 147000     LossContext: 0.00004823
    Epoch: 148000     LossContext: 0.00004818
    Epoch: 149000     LossContext: 0.00004813
    Epoch: 150000     LossContext: 0.00004808
    Epoch: 151000     LossContext: 0.00004808
    Epoch: 152000     LossContext: 0.00004807
    Epoch: 153000     LossContext: 0.00004806
    Epoch: 154000     LossContext: 0.00004806
    Epoch: 155000     LossContext: 0.00004805
    Epoch: 156000     LossContext: 0.00004804
    Epoch: 157000     LossContext: 0.00004803
    Epoch: 158000     LossContext: 0.00004803
    Epoch: 159000     LossContext: 0.00004802
    Epoch: 160000     LossContext: 0.00004801
    Epoch: 161000     LossContext: 0.00004800
    Epoch: 162000     LossContext: 0.00004800
    Epoch: 163000     LossContext: 0.00004799
    Epoch: 164000     LossContext: 0.00004798
    Epoch: 165000     LossContext: 0.00004797
    Epoch: 166000     LossContext: 0.00004797
    Epoch: 167000     LossContext: 0.00004796
    Epoch: 168000     LossContext: 0.00004795
    Epoch: 169000     LossContext: 0.00004794
    Epoch: 170000     LossContext: 0.00004794
    Epoch: 171000     LossContext: 0.00004793
    Epoch: 172000     LossContext: 0.00004792
    Epoch: 173000     LossContext: 0.00004791
    Epoch: 174000     LossContext: 0.00004791
    Epoch: 175000     LossContext: 0.00004790
    Epoch: 176000     LossContext: 0.00004789
    Epoch: 177000     LossContext: 0.00004788
    Epoch: 178000     LossContext: 0.00004788
    Epoch: 179000     LossContext: 0.00004787
    Epoch: 180000     LossContext: 0.00004786
    Epoch: 181000     LossContext: 0.00004785
    Epoch: 182000     LossContext: 0.00004785
    Epoch: 183000     LossContext: 0.00004784
    Epoch: 184000     LossContext: 0.00004783
    Epoch: 185000     LossContext: 0.00004782
    Epoch: 186000     LossContext: 0.00004782
    Epoch: 187000     LossContext: 0.00004781
    Epoch: 188000     LossContext: 0.00004780
    Epoch: 189000     LossContext: 0.00004779
    Epoch: 190000     LossContext: 0.00004779
    Epoch: 191000     LossContext: 0.00004778
    Epoch: 192000     LossContext: 0.00004777
    Epoch: 193000     LossContext: 0.00004777
    Epoch: 194000     LossContext: 0.00004776
    Epoch: 195000     LossContext: 0.00004775
    Epoch: 196000     LossContext: 0.00004774
    Epoch: 197000     LossContext: 0.00004774
    Epoch: 198000     LossContext: 0.00004773
    Epoch: 199000     LossContext: 0.00004772
    Epoch: 199999     LossContext: 0.00004771

Total gradient descent adaptation time: 0 hours 37 mins 50 secs
Environment weights at the end of the adaptation: [0.28029647 0.19286926 0.30787036 0.21896386]

Saving adaptation parameters into ./runs/31012024-090548/adapt/ folder with id 170846 ...

==  Begining out-of-distribution testing ... ==
    Number of training environments: 9
    Number of adaptation environments: 4
    Final length of the training trajectories: 20
    Length of the testing trajectories: 20
Test Score (OOD): 3.965802e-06

==  Begining out-of-distribution visualisation ... ==
    Environment id: 0
    Trajectory id: 0
    Final length of the training trajectories: 20
    Length of the testing trajectories: 20
Testing finished. Figure saved in: ./runs/31012024-090548/adapt/results_ood.png
Traceback (most recent call last):
  File "/home/gb21553/OneDrive/Nodax/examples/lotka-voltera/main.py", line 445, in <module>
    adapt_dataloader = DataLoader(adapt_folder+"adapt_huge_data.npz", adaptation=True, data_id="090142", key=seed)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gb21553/OneDrive/Nodax/nodax/dataloader.py", line 12, in __init__
    raw_dat = jnp.load(dataset)
              ^^^^^^^^^^^^^^^^^
  File "/home/gb21553/miniconda3/envs/jaxgpu/lib/python3.11/site-packages/jax/_src/numpy/lax_numpy.py", line 285, in load
    out = np.load(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gb21553/miniconda3/envs/jaxgpu/lib/python3.11/site-packages/numpy/lib/npyio.py", line 405, in load
    fid = stack.enter_context(open(os_fspath(file), "rb"))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './runs/31012024-090548/adapt/adapt_huge_data.npz'
