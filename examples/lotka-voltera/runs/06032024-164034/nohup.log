
############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: train
 Savepath: ./runs/06032024-164034/
 Seed: 2026


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: test
 Savepath: ./runs/06032024-164034/
 Seed: 4052


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]
Run folder created successfuly: ./runs/06032024-164034/
Completed copied scripts 
WARNING: You did not provide a dataloader id. A new one has been generated: 164058
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: You did not provide a dataloader id. A new one has been generated: 164059
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.


Total number of parameters in the model: 399300 


WARNING: No key provided for the context initialization. Initializing at 0.
WARNING: No key provided, using time as seed


=== Beginning training with proximal alternating minimization ... ===
    Number of examples in a batch: 4
    Maximum number of steps per inner minimization: 400
    Maximum number of outer minimizations: 960
    Maximum total number of training steps: 384000

Compiling function "train_step" for neural ode ...
Shapes of elements in a batch: (9, 4, 20, 2) (20,)

Compiling function "train_step" for context ...
Shapes of elements in a batch: (9, 4, 20, 2) (20,)
    Outer Step:     0      LossTrajs: 1.28298664     ContextsNorm: 0.00000000     ValIndCrit: 1.33305454
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    1
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 3.13e-06
        -DiffCxt:  inf
    Outer Step:     1      LossTrajs: 0.08504644     ContextsNorm: 0.00000035     ValIndCrit: 0.09035625
        -NbInnerStepsNode:  400
        -NbInnerStepsCxt:  122
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 7.86e-08
        -DiffCxt:  9.39e-08
    Outer Step:     2      LossTrajs: 0.07952896     ContextsNorm: 0.00000214     ValIndCrit: 0.08402279
        -NbInnerStepsNode:   77
        -NbInnerStepsCxt:  108
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.96e-08
        -DiffCxt:  9.23e-08
    Outer Step:     3      LossTrajs: 0.05109611     ContextsNorm: 0.00000457     ValIndCrit: 0.04613798
        -NbInnerStepsNode:  400
        -NbInnerStepsCxt:  193
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.47e-06
        -DiffCxt:  9.65e-08
    Outer Step:    10      LossTrajs: 0.00111127     ContextsNorm: 0.00000602     ValIndCrit: 0.00172942
        -NbInnerStepsNode:  186
        -NbInnerStepsCxt:   65
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.50e-08
        -DiffCxt:  9.95e-08
    Outer Step:    20      LossTrajs: 0.00065617     ContextsNorm: 0.00000617     ValIndCrit: 0.00104951
        -NbInnerStepsNode:   66
        -NbInnerStepsCxt:   58
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.95e-08
        -DiffCxt:  7.68e-08
    Outer Step:    30      LossTrajs: 0.00049731     ContextsNorm: 0.00000662     ValIndCrit: 0.00087680
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   65
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.95e-08
        -DiffCxt:  4.98e-08
    Outer Step:    40      LossTrajs: 0.00046466     ContextsNorm: 0.00000683     ValIndCrit: 0.00084663
        -NbInnerStepsNode:   16
        -NbInnerStepsCxt:   69
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.57e-08
        -DiffCxt:  6.18e-08
    Outer Step:    50      LossTrajs: 0.00038753     ContextsNorm: 0.00000657     ValIndCrit: 0.00070333
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   58
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.45e-08
        -DiffCxt:  8.26e-08
    Outer Step:    60      LossTrajs: 0.00030955     ContextsNorm: 0.00000687     ValIndCrit: 0.00059235
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   41
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.54e-08
        -DiffCxt:  9.63e-08
    Outer Step:    70      LossTrajs: 0.00035736     ContextsNorm: 0.00000692     ValIndCrit: 0.00060755
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   62
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.15e-08
        -DiffCxt:  5.76e-08
    Outer Step:    80      LossTrajs: 0.00034636     ContextsNorm: 0.00000727     ValIndCrit: 0.00063535
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   53
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 9.16e-09
        -DiffCxt:  7.61e-08
    Outer Step:    90      LossTrajs: 0.00029166     ContextsNorm: 0.00000774     ValIndCrit: 0.00060573
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   60
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 7.87e-09
        -DiffCxt:  9.21e-08
    Outer Step:   100      LossTrajs: 0.00031795     ContextsNorm: 0.00000785     ValIndCrit: 0.00059003
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   53
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 3.28e-09
        -DiffCxt:  7.77e-08
    Outer Step:   110      LossTrajs: 0.00028383     ContextsNorm: 0.00000814     ValIndCrit: 0.00055375
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   52
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 4.42e-09
        -DiffCxt:  5.98e-08
    Outer Step:   120      LossTrajs: 0.00040081     ContextsNorm: 0.00000852     ValIndCrit: 0.00064187
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   67
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.19e-08
        -DiffCxt:  9.89e-08
    Outer Step:   130      LossTrajs: 0.00030767     ContextsNorm: 0.00000888     ValIndCrit: 0.00056824
        -NbInnerStepsNode:    2
        -NbInnerStepsCxt:   66
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.12e-08
        -DiffCxt:  8.48e-08
    Outer Step:   140      LossTrajs: 0.00027502     ContextsNorm: 0.00000914     ValIndCrit: 0.00052179
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   47
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.87e-08
        -DiffCxt:  8.99e-08
    Outer Step:   150      LossTrajs: 0.00027165     ContextsNorm: 0.00000923     ValIndCrit: 0.00053751
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   64
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.49e-08
        -DiffCxt:  9.91e-08
    Outer Step:   160      LossTrajs: 0.00029316     ContextsNorm: 0.00000944     ValIndCrit: 0.00052050
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   54
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 5.09e-09
        -DiffCxt:  4.34e-08
    Outer Step:   170      LossTrajs: 0.00029015     ContextsNorm: 0.00000977     ValIndCrit: 0.00048750
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   62
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.67e-08
        -DiffCxt:  9.54e-08
    Outer Step:   180      LossTrajs: 0.00024349     ContextsNorm: 0.00000983     ValIndCrit: 0.00044698
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   65
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.81e-08
        -DiffCxt:  7.57e-08
    Outer Step:   190      LossTrajs: 0.00026077     ContextsNorm: 0.00001009     ValIndCrit: 0.00043749
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   50
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 4.44e-09
        -DiffCxt:  9.38e-08
    Outer Step:   200      LossTrajs: 0.00027361     ContextsNorm: 0.00001024     ValIndCrit: 0.00046752
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   59
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.91e-08
        -DiffCxt:  6.13e-08
    Outer Step:   210      LossTrajs: 0.00025317     ContextsNorm: 0.00001058     ValIndCrit: 0.00042375
        -NbInnerStepsNode:    2
        -NbInnerStepsCxt:   57
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.87e-08
        -DiffCxt:  6.03e-08
    Outer Step:   220      LossTrajs: 0.00022247     ContextsNorm: 0.00001073     ValIndCrit: 0.00043040
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   61
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 8.10e-09
        -DiffCxt:  8.94e-08
    Outer Step:   230      LossTrajs: 0.00023778     ContextsNorm: 0.00001089     ValIndCrit: 0.00041290
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   49
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.00e-08
        -DiffCxt:  6.08e-08
    Outer Step:   240      LossTrajs: 0.00020196     ContextsNorm: 0.00001135     ValIndCrit: 0.00039464
        -NbInnerStepsNode:    2
        -NbInnerStepsCxt:   64
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.68e-08
        -DiffCxt:  8.49e-08
    Outer Step:   250      LossTrajs: 0.00019982     ContextsNorm: 0.00001175     ValIndCrit: 0.00038788
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   52
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.53e-08
        -DiffCxt:  8.65e-08
    Outer Step:   260      LossTrajs: 0.00021843     ContextsNorm: 0.00001214     ValIndCrit: 0.00038682
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   44
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.87e-08
        -DiffCxt:  9.79e-08
    Outer Step:   270      LossTrajs: 0.00023583     ContextsNorm: 0.00001242     ValIndCrit: 0.00039148
        -NbInnerStepsNode:   26
        -NbInnerStepsCxt:   62
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.53e-08
        -DiffCxt:  7.79e-08
    Outer Step:   280      LossTrajs: 0.00021436     ContextsNorm: 0.00001282     ValIndCrit: 0.00037264
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   54
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.62e-08
        -DiffCxt:  5.04e-08
    Outer Step:   290      LossTrajs: 0.00019895     ContextsNorm: 0.00001340     ValIndCrit: 0.00037036
        -NbInnerStepsNode:    2
        -NbInnerStepsCxt:   57
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.98e-08
        -DiffCxt:  9.41e-08
    Outer Step:   300      LossTrajs: 0.00017332     ContextsNorm: 0.00001345     ValIndCrit: 0.00034787
        -NbInnerStepsNode:   51
        -NbInnerStepsCxt:   57
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.53e-08
        -DiffCxt:  5.88e-08
    Outer Step:   310      LossTrajs: 0.00016829     ContextsNorm: 0.00001391     ValIndCrit: 0.00033680
        -NbInnerStepsNode:   31
        -NbInnerStepsCxt:   43
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.60e-08
        -DiffCxt:  5.78e-08
    Outer Step:   320      LossTrajs: 0.00015676     ContextsNorm: 0.00001434     ValIndCrit: 0.00032360
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   59
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.26e-08
        -DiffCxt:  9.21e-08
    Outer Step:   330      LossTrajs: 0.00015571     ContextsNorm: 0.00001434     ValIndCrit: 0.00029767
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   49
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.23e-08
        -DiffCxt:  9.22e-08
    Outer Step:   340      LossTrajs: 0.00015490     ContextsNorm: 0.00001462     ValIndCrit: 0.00028926
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   58
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 8.18e-09
        -DiffCxt:  6.75e-08
    Outer Step:   350      LossTrajs: 0.00014128     ContextsNorm: 0.00001474     ValIndCrit: 0.00029615
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   46
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.69e-08
        -DiffCxt:  7.71e-08
    Outer Step:   360      LossTrajs: 0.00014532     ContextsNorm: 0.00001517     ValIndCrit: 0.00028519
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   61
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 5.93e-09
        -DiffCxt:  5.98e-08
    Outer Step:   370      LossTrajs: 0.00016151     ContextsNorm: 0.00001514     ValIndCrit: 0.00032406
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   52
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 9.11e-09
        -DiffCxt:  9.55e-08
    Outer Step:   380      LossTrajs: 0.00014443     ContextsNorm: 0.00001594     ValIndCrit: 0.00027765
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   57
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.77e-08
        -DiffCxt:  7.71e-08
    Outer Step:   390      LossTrajs: 0.00014842     ContextsNorm: 0.00001623     ValIndCrit: 0.00032016
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   59
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 2.00e-08
        -DiffCxt:  4.10e-08
    Outer Step:   400      LossTrajs: 0.00016444     ContextsNorm: 0.00001640     ValIndCrit: 0.00027791
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   62
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 8.11e-09
        -DiffCxt:  9.62e-08
    Outer Step:   410      LossTrajs: 0.00015069     ContextsNorm: 0.00001659     ValIndCrit: 0.00030014
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   52
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 4.99e-09
        -DiffCxt:  5.03e-08
    Outer Step:   420      LossTrajs: 0.00016130     ContextsNorm: 0.00001678     ValIndCrit: 0.00028665
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   62
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 5.69e-09
        -DiffCxt:  8.69e-08
    Outer Step:   430      LossTrajs: 0.00016924     ContextsNorm: 0.00001714     ValIndCrit: 0.00029943
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   58
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.69e-08
        -DiffCxt:  9.63e-08
    Outer Step:   440      LossTrajs: 0.00016788     ContextsNorm: 0.00001767     ValIndCrit: 0.00027177
        -NbInnerStepsNode:    2
        -NbInnerStepsCxt:   63
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.36e-08
        -DiffCxt:  9.95e-08
    Outer Step:   450      LossTrajs: 0.00016047     ContextsNorm: 0.00001794     ValIndCrit: 0.00029643
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   56
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.07e-08
        -DiffCxt:  9.05e-08
    Outer Step:   460      LossTrajs: 0.00016346     ContextsNorm: 0.00001866     ValIndCrit: 0.00026794
        -NbInnerStepsNode:   18
        -NbInnerStepsCxt:   60
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.61e-08
        -DiffCxt:  6.61e-08
    Outer Step:   470      LossTrajs: 0.00015237     ContextsNorm: 0.00001889     ValIndCrit: 0.00026308
        -NbInnerStepsNode:    3
        -NbInnerStepsCxt:   50
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.16e-08
        -DiffCxt:  9.27e-08
    Outer Step:   480      LossTrajs: 0.00012350     ContextsNorm: 0.00001901     ValIndCrit: 0.00025015
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   55
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 9.00e-09
        -DiffCxt:  7.90e-08
    Outer Step:   490      LossTrajs: 0.00013199     ContextsNorm: 0.00001916     ValIndCrit: 0.00023748
        -NbInnerStepsNode:    6
        -NbInnerStepsCxt:   50
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 2.00e-08
        -DiffCxt:  8.77e-08
    Outer Step:   500      LossTrajs: 0.00011342     ContextsNorm: 0.00001944     ValIndCrit: 0.00020625
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   50
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.25e-08
        -DiffCxt:  4.57e-08
    Outer Step:   510      LossTrajs: 0.00009753     ContextsNorm: 0.00001957     ValIndCrit: 0.00019300
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   40
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.79e-08
        -DiffCxt:  7.39e-08
    Outer Step:   520      LossTrajs: 0.00009633     ContextsNorm: 0.00002005     ValIndCrit: 0.00019188
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   51
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.01e-08
        -DiffCxt:  9.87e-08
    Outer Step:   530      LossTrajs: 0.00011643     ContextsNorm: 0.00002027     ValIndCrit: 0.00018409
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   60
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 7.82e-09
        -DiffCxt:  8.34e-08
    Outer Step:   540      LossTrajs: 0.00012329     ContextsNorm: 0.00002083     ValIndCrit: 0.00018999
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   53
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.82e-08
        -DiffCxt:  9.71e-08
    Outer Step:   550      LossTrajs: 0.00010200     ContextsNorm: 0.00002084     ValIndCrit: 0.00018196
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   38
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 3.89e-09
        -DiffCxt:  9.04e-08
    Outer Step:   560      LossTrajs: 0.00012024     ContextsNorm: 0.00002088     ValIndCrit: 0.00019553
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   56
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.36e-08
        -DiffCxt:  8.49e-08
    Outer Step:   570      LossTrajs: 0.00011355     ContextsNorm: 0.00002134     ValIndCrit: 0.00020261
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   47
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 6.32e-09
        -DiffCxt:  9.67e-08
    Outer Step:   580      LossTrajs: 0.00010810     ContextsNorm: 0.00002166     ValIndCrit: 0.00018478
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   54
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.63e-08
        -DiffCxt:  7.66e-08
    Outer Step:   590      LossTrajs: 0.00010337     ContextsNorm: 0.00002220     ValIndCrit: 0.00016680
        -NbInnerStepsNode:  167
        -NbInnerStepsCxt:   54
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.31e-08
        -DiffCxt:  7.71e-08
    Outer Step:   600      LossTrajs: 0.00009963     ContextsNorm: 0.00002217     ValIndCrit: 0.00016601
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   37
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 4.60e-09
        -DiffCxt:  9.33e-08
    Outer Step:   610      LossTrajs: 0.00009007     ContextsNorm: 0.00002273     ValIndCrit: 0.00016833
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   54
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 8.73e-09
        -DiffCxt:  7.65e-08
    Outer Step:   620      LossTrajs: 0.00011192     ContextsNorm: 0.00002311     ValIndCrit: 0.00016894
        -NbInnerStepsNode:   53
        -NbInnerStepsCxt:   55
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.93e-08
        -DiffCxt:  9.80e-08
    Outer Step:   630      LossTrajs: 0.00008462     ContextsNorm: 0.00002371     ValIndCrit: 0.00016559
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   62
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.93e-08
        -DiffCxt:  5.38e-08
    Outer Step:   640      LossTrajs: 0.00007883     ContextsNorm: 0.00002432     ValIndCrit: 0.00015125
        -NbInnerStepsNode:    2
        -NbInnerStepsCxt:   51
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 7.86e-09
        -DiffCxt:  7.50e-08
    Outer Step:   650      LossTrajs: 0.00010010     ContextsNorm: 0.00002477     ValIndCrit: 0.00016166
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   57
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.65e-08
        -DiffCxt:  9.39e-08
    Outer Step:   660      LossTrajs: 0.00007492     ContextsNorm: 0.00002521     ValIndCrit: 0.00014869
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   31
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 7.15e-09
        -DiffCxt:  5.40e-08
    Outer Step:   670      LossTrajs: 0.00007595     ContextsNorm: 0.00002535     ValIndCrit: 0.00012587
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   52
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 8.55e-09
        -DiffCxt:  8.33e-08
    Outer Step:   680      LossTrajs: 0.00006044     ContextsNorm: 0.00002517     ValIndCrit: 0.00011952
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   51
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.95e-08
        -DiffCxt:  9.77e-08
    Outer Step:   690      LossTrajs: 0.00006355     ContextsNorm: 0.00002556     ValIndCrit: 0.00012997
        -NbInnerStepsNode:   20
        -NbInnerStepsCxt:   49
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.73e-08
        -DiffCxt:  7.26e-08
    Outer Step:   700      LossTrajs: 0.00007691     ContextsNorm: 0.00002592     ValIndCrit: 0.00010933
        -NbInnerStepsNode:  103
        -NbInnerStepsCxt:   46
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.83e-08
        -DiffCxt:  8.88e-08
    Outer Step:   710      LossTrajs: 0.00007189     ContextsNorm: 0.00002618     ValIndCrit: 0.00010967
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   55
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.26e-08
        -DiffCxt:  8.71e-08
    Outer Step:   720      LossTrajs: 0.00007643     ContextsNorm: 0.00002628     ValIndCrit: 0.00010593
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   54
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.09e-08
        -DiffCxt:  8.38e-08
    Outer Step:   730      LossTrajs: 0.00005968     ContextsNorm: 0.00002650     ValIndCrit: 0.00010026
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   51
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.73e-08
        -DiffCxt:  7.49e-08
    Outer Step:   740      LossTrajs: 0.00007502     ContextsNorm: 0.00002697     ValIndCrit: 0.00010535
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   51
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 9.24e-09
        -DiffCxt:  7.14e-08
    Outer Step:   750      LossTrajs: 0.00006036     ContextsNorm: 0.00002690     ValIndCrit: 0.00009727
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   41
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.01e-08
        -DiffCxt:  9.12e-08
    Outer Step:   760      LossTrajs: 0.00004973     ContextsNorm: 0.00002700     ValIndCrit: 0.00008760
        -NbInnerStepsNode:    3
        -NbInnerStepsCxt:   49
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 4.48e-09
        -DiffCxt:  5.71e-08
    Outer Step:   770      LossTrajs: 0.00005113     ContextsNorm: 0.00002754     ValIndCrit: 0.00010303
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   47
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 3.50e-09
        -DiffCxt:  9.11e-08
    Outer Step:   780      LossTrajs: 0.00004929     ContextsNorm: 0.00002785     ValIndCrit: 0.00009733
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   49
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 5.69e-09
        -DiffCxt:  9.71e-08
    Outer Step:   790      LossTrajs: 0.00005115     ContextsNorm: 0.00002808     ValIndCrit: 0.00009267
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   60
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.16e-08
        -DiffCxt:  7.74e-08
    Outer Step:   800      LossTrajs: 0.00004942     ContextsNorm: 0.00002813     ValIndCrit: 0.00009681
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   47
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 5.60e-09
        -DiffCxt:  9.77e-08
    Outer Step:   810      LossTrajs: 0.00005068     ContextsNorm: 0.00002861     ValIndCrit: 0.00008774
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   49
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 6.49e-09
        -DiffCxt:  8.24e-08
    Outer Step:   820      LossTrajs: 0.00006014     ContextsNorm: 0.00002867     ValIndCrit: 0.00009422
        -NbInnerStepsNode:   46
        -NbInnerStepsCxt:   49
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.85e-08
        -DiffCxt:  9.02e-08
    Outer Step:   830      LossTrajs: 0.00004504     ContextsNorm: 0.00002884     ValIndCrit: 0.00008308
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   42
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.70e-08
        -DiffCxt:  9.66e-08
    Outer Step:   840      LossTrajs: 0.00004358     ContextsNorm: 0.00002902     ValIndCrit: 0.00008730
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   49
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.58e-08
        -DiffCxt:  7.42e-08
    Outer Step:   850      LossTrajs: 0.00004880     ContextsNorm: 0.00002979     ValIndCrit: 0.00007541
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   53
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.41e-08
        -DiffCxt:  9.39e-08
    Outer Step:   860      LossTrajs: 0.00003807     ContextsNorm: 0.00003018     ValIndCrit: 0.00006718
        -NbInnerStepsNode:  121
        -NbInnerStepsCxt:   33
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.17e-08
        -DiffCxt:  6.92e-08
    Outer Step:   870      LossTrajs: 0.00003360     ContextsNorm: 0.00003058     ValIndCrit: 0.00006227
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   41
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.78e-08
        -DiffCxt:  8.85e-08
    Outer Step:   880      LossTrajs: 0.00004671     ContextsNorm: 0.00003063     ValIndCrit: 0.00007570
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   52
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.68e-08
        -DiffCxt:  7.54e-08
    Outer Step:   890      LossTrajs: 0.00003293     ContextsNorm: 0.00003081     ValIndCrit: 0.00006328
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   44
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 2.79e-09
        -DiffCxt:  8.84e-08
    Outer Step:   900      LossTrajs: 0.00003990     ContextsNorm: 0.00003103     ValIndCrit: 0.00007553
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   48
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 7.24e-09
        -DiffCxt:  8.73e-08
    Outer Step:   910      LossTrajs: 0.00004088     ContextsNorm: 0.00003114     ValIndCrit: 0.00007201
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   43
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 9.80e-09
        -DiffCxt:  9.07e-08
    Outer Step:   920      LossTrajs: 0.00004088     ContextsNorm: 0.00003218     ValIndCrit: 0.00006611
        -NbInnerStepsNode:   22
        -NbInnerStepsCxt:   39
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.93e-08
        -DiffCxt:  6.60e-08
    Outer Step:   930      LossTrajs: 0.00003741     ContextsNorm: 0.00003259     ValIndCrit: 0.00006687
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   40
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.62e-08
        -DiffCxt:  7.79e-08
    Outer Step:   940      LossTrajs: 0.00003649     ContextsNorm: 0.00003300     ValIndCrit: 0.00007646
        -NbInnerStepsNode:   58
        -NbInnerStepsCxt:   57
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 1.51e-08
        -DiffCxt:  7.99e-08
    Outer Step:   950      LossTrajs: 0.00004813     ContextsNorm: 0.00003320     ValIndCrit: 0.00006244
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   48
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 9.19e-09
        -DiffCxt:  7.92e-08
    Outer Step:   959      LossTrajs: 0.00003336     ContextsNorm: 0.00003338     ValIndCrit: 0.00006626
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:   52
        -InnerToleranceNode: 2.00e-08
        -InnerToleranceCtx:  1.00e-07
        -DiffNode: 9.86e-09
        -DiffCxt:  7.80e-08

Total gradient descent training time: 9 hours 20 mins 29 secs
Environment weights at the end of the training: [0.11111111 0.11111111 0.11111111 0.11111111 0.11111111 0.11111111
 0.11111111 0.11111111 0.11111111]
WARNING: You did not provide a dataloader id. A new one has been generated: 020129
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: No key provided, using time as seed
==  Begining in-domain testing ... ==
    Number of training environments: 9
    Final length of the training trajectories: 20
    Length of the testing trajectories: 20
Test Score (In-Domain): 6.625809e-05


############# Inductive Bias Learning for Dynamical Systems #############

Jax version: 0.4.23
Available devices: [cuda(id=0)]
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: adapt
 Savepath: ./runs/06032024-164034/adapt/
 Seed: 6078

==  Begining in-domain visualisation ... ==
    Environment id: 7
    Trajectory id: 9
    Visualized dimensions: (0, 1)
    Final length of the training trajectories: 20
    Length of the testing trajectories: 20
Testing finished. Figure saved in: ./runs/06032024-164034/results_in_domain.png
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: No key provided for the context initialization. Initializing at 0.


=== Beginning adaptation ... ===
    Number of examples in a batch: 1
    Number of train steps per epoch: 1
    Number of training epochs: 24
    Total number of training steps: 24
WARNING: No key provided, using time as seed

Compiling function "train_step" for context ...
Shapes of elements in a batch: (4, 1, 20, 2) (20,)
    Epoch:     0     LossContext: 0.05003873
    Epoch:     1     LossContext: 0.04711501
    Epoch:     2     LossContext: 0.04425140
    Epoch:     3     LossContext: 0.04146551
    Epoch:    10     LossContext: 0.02522449
    Epoch:    20     LossContext: 0.01252317
    Epoch:    23     LossContext: 0.01043854

Total gradient descent adaptation time: 0 hours 0 mins 13 secs
Environment weights at the end of the adaptation: [0.25 0.25 0.25 0.25]

Saving adaptation parameters into ./runs/06032024-164034/adapt/ folder with id 170846 ...

==  Begining out-of-distribution testing ... ==
    Number of training environments: 9
    Number of adaptation environments: 4
    Final length of the training trajectories: 20
    Length of the testing trajectories: 20
Test Score (OOD): 0.00969749

