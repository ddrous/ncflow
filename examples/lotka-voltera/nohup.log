
############# Neural Context Flow #############

Jax version: 0.4.35
Available devices: [CudaDevice(id=0)]
NCF variant: NCF-t22
Created a new run folder at: ./runs/250225-095900/
 Backed up run script and module files 
 Created an adaptation folder at: ./runs/250225-095900/adapt/
 Created a checkpoints folder at: ./runs/250225-095900/checkpoints/
== Properties of the data ==
Number of environments: 9
Number of trajectories per environment: 4
Number of steps per trajectory: 20
Data size: 2
WARNING: No key provided for the context initialization. Initializing at 0.


Total number of parameters in the neural ode: 308240
Total number of parameters in the contexts: 9216 


WARNING: No key provided for splitting, using time as seed


=== Beginning training with proximal alternating minimization ... ===
    Number of examples in a batch: 4
    Maximum number of steps per inner minimization: 25
    Maximum number of outer minimizations: 2000
    Maximum total number of training steps: 50000

Compiling function "train_step" for neural ode ...
Shapes of elements in a batch: (9, 4, 20, 2) (20,) 


Compiling function "train_step" for contexts ...
Shapes of elements in a batch: (9, 4, 20, 2) (20,) 

    Outer Step:     0      LossTrajs: 1.81636143     ContextsNorm: 0.00000000     ValIndCrit: 1.70390344
        Saving best model so far ...
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    1
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 1.71e-06
        -DiffCxt:  inf
    Outer Step:     1      LossTrajs: 1.53356671     ContextsNorm: 0.00133133     ValIndCrit: 1.43726349
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 1.67e-06
        -DiffCxt:  5.62e-04
    Outer Step:     2      LossTrajs: 1.23031986     ContextsNorm: 0.00392249     ValIndCrit: 1.14925134
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 1.11e-05
        -DiffCxt:  7.08e-04
    Outer Step:     3      LossTrajs: 0.81609255     ContextsNorm: 0.00775038     ValIndCrit: 0.75058514
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 3.19e-05
        -DiffCxt:  3.82e-04
    Outer Step:    10      LossTrajs: 0.23073556     ContextsNorm: 0.00972561     ValIndCrit: 0.27381992
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 1.34e-07
        -DiffCxt:  6.32e-06
    Outer Step:    20      LossTrajs: 0.16432954     ContextsNorm: 0.01050427     ValIndCrit: 0.18789490
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 2.51e-07
        -DiffCxt:  3.79e-07
    Outer Step:    30      LossTrajs: 0.07214438     ContextsNorm: 0.01077219     ValIndCrit: 0.07414887
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 5.63e-07
        -DiffCxt:  2.85e-06
    Outer Step:    40      LossTrajs: 0.02169011     ContextsNorm: 0.01407557     ValIndCrit: 0.02313192
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 7.87e-07
        -DiffCxt:  2.15e-06
    Outer Step:    50      LossTrajs: 0.01017837     ContextsNorm: 0.01489381     ValIndCrit: 0.01258055
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 6.31e-08
        -DiffCxt:  1.15e-07
    Outer Step:    60      LossTrajs: 0.00703708     ContextsNorm: 0.01479864     ValIndCrit: 0.00933097
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 3.63e-08
        -DiffCxt:  4.80e-08
    Outer Step:    70      LossTrajs: 0.00534668     ContextsNorm: 0.01484251     ValIndCrit: 0.00766891
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 9.00e-08
        -DiffCxt:  4.22e-08
    Outer Step:    80      LossTrajs: 0.00427498     ContextsNorm: 0.01469177     ValIndCrit: 0.00656655
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 1.78e-08
        -DiffCxt:  6.20e-08
    Outer Step:    90      LossTrajs: 0.00335755     ContextsNorm: 0.01476007     ValIndCrit: 0.00544453
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 1.74e-08
        -DiffCxt:  1.48e-07
    Outer Step:   100      LossTrajs: 0.00241339     ContextsNorm: 0.01467148     ValIndCrit: 0.00421832
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 2.11e-08
        -DiffCxt:  1.89e-07
    Outer Step:   110      LossTrajs: 0.00171910     ContextsNorm: 0.01459014     ValIndCrit: 0.00326140
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 1.91e-08
        -DiffCxt:  5.11e-08
    Outer Step:   120      LossTrajs: 0.00128679     ContextsNorm: 0.01444892     ValIndCrit: 0.00254025
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 1.59e-08
        -DiffCxt:  2.52e-08
    Outer Step:   130      LossTrajs: 0.00092736     ContextsNorm: 0.01454931     ValIndCrit: 0.00192448
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 2.39e-08
        -DiffCxt:  3.65e-08
    Outer Step:   140      LossTrajs: 0.00068642     ContextsNorm: 0.01451670     ValIndCrit: 0.00147904
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 2.01e-08
        -DiffCxt:  2.65e-08
    Outer Step:   150      LossTrajs: 0.00051106     ContextsNorm: 0.01439955     ValIndCrit: 0.00111228
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 6.07e-09
        -DiffCxt:  2.46e-08
    Outer Step:   160      LossTrajs: 0.00037505     ContextsNorm: 0.01431250     ValIndCrit: 0.00085563
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 1.18e-08
        -DiffCxt:  2.33e-08
    Outer Step:   170      LossTrajs: 0.00031085     ContextsNorm: 0.01430635     ValIndCrit: 0.00065546
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 9.79e-09
        -DiffCxt:  1.09e-08
    Outer Step:   180      LossTrajs: 0.00023927     ContextsNorm: 0.01431786     ValIndCrit: 0.00050386
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 8.62e-09
        -DiffCxt:  1.77e-08
    Outer Step:   190      LossTrajs: 0.00018844     ContextsNorm: 0.01424524     ValIndCrit: 0.00040601
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 1.44e-08
        -DiffCxt:  2.56e-08
    Outer Step:   200      LossTrajs: 0.00015581     ContextsNorm: 0.01427525     ValIndCrit: 0.00034458
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 2.50e-08
        -DiffCxt:  4.32e-08
    Outer Step:   210      LossTrajs: 0.00014123     ContextsNorm: 0.01427275     ValIndCrit: 0.00028829
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 6.33e-08
        -DiffCxt:  5.36e-08
    Outer Step:   220      LossTrajs: 0.00011412     ContextsNorm: 0.01423432     ValIndCrit: 0.00026049
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 8.83e-09
        -DiffCxt:  2.78e-08
    Outer Step:   230      LossTrajs: 0.00010255     ContextsNorm: 0.01419672     ValIndCrit: 0.00023331
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 3.99e-08
        -DiffCxt:  1.05e-07
    Outer Step:   240      LossTrajs: 0.00009374     ContextsNorm: 0.01414939     ValIndCrit: 0.00020766
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 1.41e-08
        -DiffCxt:  1.31e-07
    Outer Step:   250      LossTrajs: 0.00008019     ContextsNorm: 0.01413404     ValIndCrit: 0.00017706
        Saving best model so far ...
        -NbInnerStepsNode:   25
        -NbInnerStepsCxt:   25
        -InnerToleranceNode: 1.00e-12
        -InnerToleranceCtx:  1.00e-12
        -DiffNode: 1.95e-08
        -DiffCxt:  2.19e-07
