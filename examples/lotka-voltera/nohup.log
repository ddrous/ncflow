
############# Neural Context Flow #############

Jax version: 0.4.28
Available devices: [cuda(id=0)]
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: train
 Savepath: ./runs/04082024-044750/
 Seed: 2026


############# Neural Context Flow #############

Jax version: 0.4.28
Available devices: [cuda(id=0)]
Running this script in ipython (Jupyter) session ? False
=== Parsed arguments to generate data ===
 Split: test
 Savepath: ./runs/04082024-044750/
 Seed: 4052


############# Neural Context Flow #############

Jax version: 0.4.28
Available devices: [cuda(id=0)]
Completed copied scripts 
WARNING: You did not provide a dataloader id. A new one has been generated: 044809
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.
WARNING: You did not provide a dataloader id. A new one has been generated: 044809
WARNING: Note that this id used to distuinguish between adaptations to different environments.
WARNING: batch_size must be between 0 and nb_trajs_per_env. Setting batch_size to maximum.


Total number of parameters in the model: 308240 


WARNING: No key provided for the context initialization. Initializing at 0.
WARNING: No key provided, using time as seed


=== Beginning training with proximal alternating minimization ... ===
    Number of examples in a batch: 4
    Maximum number of steps per inner minimization: 30
    Maximum number of outer minimizations: 1500
    Maximum total number of training steps: 45000

Compiling function "train_step" for neural ode ...
Shapes of elements in a batch: (9, 4, 20, 2) (20,)

Compiling function "train_step" for context ...
Shapes of elements in a batch: (9, 4, 20, 2) (20,)
    Outer Step:     0      LossTrajs: 1.81051505     ContextsNorm: 0.00000000     ValIndCrit: 1.67688727
        Saving best model so far ...
        -NbInnerStepsNode:    1
        -NbInnerStepsCxt:    1
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 1.53e-05
        -DiffCxt:  inf
    Outer Step:     1      LossTrajs: 0.73967505     ContextsNorm: 0.00702437     ValIndCrit: 0.66575879
        Saving best model so far ...
        -NbInnerStepsNode:   30
        -NbInnerStepsCxt:   30
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 2.80e-05
        -DiffCxt:  6.58e-04
    Outer Step:     2      LossTrajs: 0.26744506     ContextsNorm: 0.00671160     ValIndCrit: 0.30575338
        Saving best model so far ...
        -NbInnerStepsNode:   30
        -NbInnerStepsCxt:   30
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 8.29e-05
        -DiffCxt:  5.24e-04
    Outer Step:     3      LossTrajs: 0.24276815     ContextsNorm: 0.01051180     ValIndCrit: 0.28155389
        Saving best model so far ...
        -NbInnerStepsNode:   30
        -NbInnerStepsCxt:   30
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 1.51e-05
        -DiffCxt:  1.06e-04
    Outer Step:    10      LossTrajs: 0.04997690     ContextsNorm: 0.01363457     ValIndCrit: 0.04866064
        Saving best model so far ...
        -NbInnerStepsNode:   30
        -NbInnerStepsCxt:   30
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 1.26e-05
        -DiffCxt:  2.04e-05
    Outer Step:    20      LossTrajs: 0.00601739     ContextsNorm: 0.01445019     ValIndCrit: 0.00780487
        Saving best model so far ...
        -NbInnerStepsNode:   30
        -NbInnerStepsCxt:   30
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 2.28e-07
        -DiffCxt:  7.40e-08
    Outer Step:    30      LossTrajs: 0.00247532     ContextsNorm: 0.01482980     ValIndCrit: 0.00432815
        Saving best model so far ...
        -NbInnerStepsNode:   30
        -NbInnerStepsCxt:   30
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 4.76e-08
        -DiffCxt:  6.20e-08
    Outer Step:    40      LossTrajs: 0.00137685     ContextsNorm: 0.01479139     ValIndCrit: 0.00285316
        Saving best model so far ...
        -NbInnerStepsNode:   30
        -NbInnerStepsCxt:   30
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 1.94e-08
        -DiffCxt:  4.24e-08
    Outer Step:    50      LossTrajs: 0.00068742     ContextsNorm: 0.01441937     ValIndCrit: 0.00159862
        Saving best model so far ...
        -NbInnerStepsNode:   30
        -NbInnerStepsCxt:   30
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 1.37e-08
        -DiffCxt:  6.31e-08
    Outer Step:    60      LossTrajs: 0.00037813     ContextsNorm: 0.01417959     ValIndCrit: 0.00089925
        Saving best model so far ...
        -NbInnerStepsNode:   30
        -NbInnerStepsCxt:   30
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 5.22e-08
        -DiffCxt:  2.57e-07
    Outer Step:    70      LossTrajs: 0.00021938     ContextsNorm: 0.01406421     ValIndCrit: 0.00053322
        Saving best model so far ...
        -NbInnerStepsNode:   30
        -NbInnerStepsCxt:   30
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 1.41e-08
        -DiffCxt:  3.37e-08
    Outer Step:    80      LossTrajs: 0.00013591     ContextsNorm: 0.01402307     ValIndCrit: 0.00033384
        Saving best model so far ...
        -NbInnerStepsNode:   30
        -NbInnerStepsCxt:   22
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 2.64e-09
        -DiffCxt:  9.98e-09
    Outer Step:    90      LossTrajs: 0.00010664     ContextsNorm: 0.01405787     ValIndCrit: 0.00023340
        Saving best model so far ...
        -NbInnerStepsNode:   30
        -NbInnerStepsCxt:   30
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 7.73e-08
        -DiffCxt:  7.74e-07
    Outer Step:   100      LossTrajs: 0.00007716     ContextsNorm: 0.01399985     ValIndCrit: 0.00018791
        Saving best model so far ...
        -NbInnerStepsNode:   30
        -NbInnerStepsCxt:   30
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 1.04e-08
        -DiffCxt:  1.17e-07
    Outer Step:   110      LossTrajs: 0.00006818     ContextsNorm: 0.01392607     ValIndCrit: 0.00015111
        Saving best model so far ...
        -NbInnerStepsNode:   30
        -NbInnerStepsCxt:   30
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCtx:  1.00e-08
        -DiffNode: 4.01e-08
        -DiffCxt:  7.96e-08
